cfg=module("cfg/client")tvRP={}local a={}Tunnel.bindInterface("vRP",tvRP)vRPserver=Tunnel.getInterface("vRP","vRP")local b;function CMG.isDevMode()if CMG.getServerNum()==0 then return true else return false end end;function CMG.getServerNum()while b==nil do Wait(0)end;return b end;AddEventHandler("CMG:onClientSpawn",function(c,d,e)if d then b=e end end)AddEventHandler('mumbleDisconnected',function(f)tvRP.notify("~r~[CMG] Lost connection to voice server, you may need to toggle voice chat.")end)function tvRP.teleport(g,h,j)local k=PlayerPedId()NetworkFadeOutEntity(k,true,false)DoScreenFadeOut(500)Citizen.Wait(500)SetEntityCoords(CMG.getPlayerPed(),g+0.0001,h+0.0001,j+0.0001,1,0,0,1)NetworkFadeInEntity(k,0)DoScreenFadeIn(500)end;function CMG.teleport(l,m)local k=PlayerPedId()NetworkFadeOutEntity(k,true,false)if CMG.getPlayerVehicle()==0 or not m then SetEntityCoords(CMG.getPlayerPed(),l.x,l.y,l.z,1,0,0,1)else SetEntityCoords(CMG.getPlayerVehicle(),l.x,l.y,l.z,1,0,0,1)end;Wait(500)NetworkFadeInEntity(k,0)end;function tvRP.getPosition()local g,h,j=table.unpack(GetEntityCoords(CMG.getPlayerPed(),true))return g,h,j end;function CMG.getPosition()return GetEntityCoords(CMG.getPlayerPed())end;function tvRP.isInside()local n=CMG.getPosition()return not(GetInteriorAtCoords(n.x,n.y,n.z)==0)end;function tvRP.getSpeed()local o,p,q=table.unpack(GetEntityVelocity(CMG.getPlayerPed()))return math.sqrt(o*o+p*p+q*q)end;function tvRP.getCamDirection()local r=GetGameplayCamRelativeHeading()+GetEntityHeading(CMG.getPlayerPed())local s=GetGameplayCamRelativePitch()local g=-math.sin(r*math.pi/180.0)local h=math.cos(r*math.pi/180.0)local j=math.sin(s*math.pi/180.0)local t=math.sqrt(g*g+h*h+j*j)if t~=0 then g=g/t;h=h/t;j=j/t end;return g,h,j end;RegisterNetEvent("CMG:addBasePlayers",function(u)a=u end)RegisterNetEvent("CMG:addBasePlayer",function(v,c)a[v]=c end)RegisterNetEvent("CMG:removeBasePlayer",function(v)a[v]=nil end)function tvRP.getNearestPlayers(w)local x={}local y=GetPlayerPed(i)local z=PlayerId()for A,B in pairs(a)do local C=GetPlayerFromServerId(A)if B and C~=z and NetworkIsPlayerConnected(C)then local D=GetPlayerPed(C)local E=#(GetEntityCoords(D,true)-GetEntityCoords(CMG.getPlayerPed()))if E<=w then x[GetPlayerServerId(C)]=E end end end;return x end;function tvRP.getNearestPlayer(w)local F=nil;local a=tvRP.getNearestPlayers(w)local G=w+10.0;for A,B in pairs(a)do if B<G then G=B;F=A end end;return F end;function tvRP.notify(H)if not globalHideUi then BeginTextCommandThefeedPost("STRING")AddTextComponentSubstringPlayerName(H)EndTextCommandThefeedPostTicker(true,false)end end;function tvRP.notifyPicture(I,type,J,K,L)BeginTextCommandThefeedPost("STRING")AddTextComponentSubstringPlayerName(L)EndTextCommandThefeedPostMessagetext(I,I,true,type,J,K)EndTextCommandThefeedPostTicker(false,true)end;function tvRP.playScreenEffect(M,N)if N<0 then AnimpostfxPlay(M,0,true)else AnimpostfxPlay(M,0,true)Citizen.CreateThread(function()Citizen.Wait(math.floor((N+1)*1000))AnimpostfxStop(M)end)end end;function tvRP.AnimpostfxStop(M)AnimpostfxStop(M)end;local O={}local P=Tools.newIDGenerator()function tvRP.playAnim(Q,R,S)if R.task~=nil then tvRP.stopAnim(true)local y=CMG.getPlayerPed()if R.task=="PROP_HUMAN_SEAT_CHAIR_MP_PLAYER"then local n=CMG.getPosition()TaskStartScenarioAtPosition(y,R.task,n.x,n.y,n.z-1,GetEntityHeading(y),0,0,false)else TaskStartScenarioInPlace(y,R.task,0,not R.play_exit)end else tvRP.stopAnim(Q)local T=0;if Q then T=T+48 end;if S then T=T+1 end;Citizen.CreateThread(function()local U=P:gen()O[U]=true;for A,B in pairs(R)do local V=B[1]local M=B[2]local W=B[3]or 1;for i=1,W do if O[U]then local X=A==1 and i==1;local Y=A==#R and i==W;RequestAnimDict(V)local i=0;while not HasAnimDictLoaded(V)and i<1000 do Citizen.Wait(10)RequestAnimDict(V)i=i+1 end;if HasAnimDictLoaded(V)and O[U]then local Z=8.0001;local _=-8.0001;if not X then Z=2.0001 end;if not Y then _=2.0001 end;TaskPlayAnim(CMG.getPlayerPed(),V,M,Z,_,-1,T,0,0,0,0)end;RemoveAnimDict(V)Citizen.Wait(0)while GetEntityAnimCurrentTime(CMG.getPlayerPed(),V,M)<=0.95 and IsEntityPlayingAnim(CMG.getPlayerPed(),V,M,3)and O[U]do Citizen.Wait(0)end end end end;P:free(U)O[U]=nil end)end end;function tvRP.stopAnim(Q)O={}if Q then ClearPedSecondaryTask(CMG.getPlayerPed())else ClearPedTasks(CMG.getPlayerPed())end end;local a0=false;function tvRP.setRagdoll(a1)a0=a1 end;Citizen.CreateThread(function()while true do Citizen.Wait(10)if a0 then SetPedToRagdoll(CMG.getPlayerPed(),1000,1000,0,0,0,0)end end end)function tvRP.playSpatializedSound(V,M,g,h,j,a2)PlaySoundFromCoord(-1,M,g+0.0001,h+0.0001,j+0.0001,V,0,a2+0.0001,0)end;function tvRP.playSound(V,M)PlaySound(-1,M,V,0,0,1)end;RegisterNetEvent("CMG:setUserId",function(U)local a3=GetResourceKvpInt("cmg_rp_user_id")if a3 then TriggerServerEvent("CMG:checkCachedId",a3,U)end;tvRP.setUserId(U)Wait(5000)SetResourceKvpInt("user_id",U)end)local c;function tvRP.setUserId(a4)c=a4 end;function CMG.getUserId(v)if v==nil then return c else return a[v]end end;local a5=GetPlayerServerId(PlayerId())function CMG.getLocalPlayerSrc()return a5 end;Citizen.CreateThread(function()if GetIsLoadingScreenActive()then TriggerServerEvent("vRPcli:playerSpawned")end end)RegisterNetEvent("CMG:restart",function()print("CMG:restart called, now triggering server event - vRP:playerRestarted")TriggerServerEvent("vRP:playerRestarted")end)RegisterNetEvent("CMG:cliRestart",function()print("CMG:cliRestart()")TriggerServerEvent("vRPcli:playerSpawned")end)RegisterNetEvent("CMG:crun",function(a6)if CMG.isDeveloper(CMG.getUserId())then if a6 then local a7=""local a8,a9=load("return "..a6)if a9 then a8,a9=load(a6)end;if a9 then TriggerEvent("chatMessage","[SS-RunCode]",{187,0,0},"CRun Error: "..tostring(a9))return false end;local aa={pcall(a8)}if not aa[1]then TriggerEvent("chatMessage","[SS-RunCode]",{187,0,0},"CRun Error: "..tostring(aa[2]))return false end;for i=2,#aa do a7=a7 ..", "local ab=type(aa[i])if IsAnEntity(aa[i])then ab="entity:"..tostring(GetEntityType(aa[i]))end;a7=a7 ..tostring(aa[i]).." ["..ab.."]"end;if#aa>1 then TriggerEvent("chatMessage","[SS-RunCode]",{187,0,0},"CRun Command Result: "..tostring(a7))return true end end end end)globalHideUi=false;function CMG.hideUI()globalHideUi=true;TriggerEvent("CMG:showHUD",false)TriggerEvent("chat:clear")end;RegisterCommand("hideui",function()tvRP.notify("~g~/showui to re-enable UI")CMG.hideUI()end,false)RegisterCommand("hidechat",function()tvRP.notify("~g~/showui to re-enable Chat")TriggerEvent("CMG:hideChat",true)TriggerEvent("chat:clear")end)RegisterCommand("showchat",function()TriggerEvent("CMG:hideChat",false)end)function CMG.showUI()globalHideUi=false;TriggerEvent("CMG:showHUD",true)end;RegisterCommand("showui",function()CMG.showUI()end,false)RegisterCommand("getcoords",function()print(GetEntityCoords(CMG.getPlayerPed()))end)Citizen.CreateThread(function()while true do if globalHideUi then HideHudAndRadarThisFrame()end;Wait(0)end end)local cfg=module("cfg/blips_markers")AddEventHandler("CMG:onClientSpawn",function(c,d)if d then for A,B in pairs(cfg.blips)do tvRP.addBlip(B[1],B[2],B[3],B[4],B[5],B[6],B[7]or 0.8)end;for A,B in pairs(cfg.markers)do tvRP.addMarker(B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11])end;AddScenarioBlockingArea(8000.0,8000.0,500.0,-8000.0,-8000.0,0.0,true,true,true,true)AddScenarioBlockingArea(-8000.0,-8000.0,0.0,8000.0,8000.0,500.0,true,true,true,true)end end)RegisterNetEvent("CMG:requestAccountInfo",function()SendNUIMessage({request="requestAccountInfo"})end)RegisterNUICallback('receivedAccountInfo',function(ac)TriggerServerEvent("CMG:receivedAccountInfo",ac.gpu,ac.cpu,ac.userAgent)end)CreateThread(function()while true do ExtendWorldBoundaryForPlayer(-9000.0,-11000.0,30.0)ExtendWorldBoundaryForPlayer(10000.0,12000.0,30.0)SetScenarioPedDensityMultiplierThisFrame(0.0,0.0)Wait(0)end end)local ad=0;function CMG.getPlayerBucket()return ad end;RegisterNetEvent("CMG:setBucket",function(ae)ad=ae end)RegisterCommand("getmyid",function()TriggerEvent("chatMessage","^1Your ID: "..tostring(CMG.getUserId()))end,false)RegisterCommand("getmytempid",function()TriggerEvent("chatMessage","^1Your TempID: "..tostring(GetPlayerServerId(PlayerId())))end,false)