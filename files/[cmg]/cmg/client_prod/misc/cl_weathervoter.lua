local function a()if CMG.isHalloween()then return"HALLOWEEN"elseif CMG.isChristmas()then return"XMAS"else return"EXTRASUNNY"end end;local b=a()local c={h=12,m=0,s=0}local d=false;local function e(f)b=f;ClearOverrideWeather()ClearWeatherTypePersist()SetWeatherTypePersist(b)SetWeatherTypeNow(b)SetWeatherTypeNowPersist(b)if b=='XMAS'then SetForceVehicleTrails(true)SetForcePedFootstepsTracks(true)else SetForceVehicleTrails(false)SetForcePedFootstepsTracks(false)end end;function CMG.setTime(g,h,i)c={h=g,m=h,s=i}end;function CMG.overrideTime(g,h,i)c.h=g;c.m=h;c.s=i;d=true end;function CMG.cancelOverrideTimeWeather()d=false;TriggerServerEvent("CMG:requestTimeWeatherSync")end;function CMG.setWeather(j)b=j end;function func_manageTimeAndWeather()NetworkOverrideClockTime(c.h,c.m,c.s)e(b)end;CMG.createThreadOnTick(func_manageTimeAndWeather)RegisterNetEvent("CMG:setTime",function(g,h,i)if not CMG.inEvent()then CMG.setTime(g,h,i)end end)RegisterNetEvent("CMG:setWeather",function(j)if not CMG.inEvent()then CMG.setWeather(j)end end)Citizen.CreateThread(function()while true do Citizen.Wait(1000)c.s=c.s+10;if c.s==60 then c.s=0;c.m=c.m+1 end;if c.m==60 then c.m=0;c.h=c.h+1 end;if c.h==24 then c.h=0 end;if not d then CMG.setTime(c.h,c.m,c.s)end end end)local k=false;local l=false;local m=60;local n={["CLEAR"]=0,["EXTRASUNNY"]=0,["CLOUDS"]=0,["OVERCAST"]=0,["RAIN"]=0,["THUNDER"]=0,["HALLOWEEN"]=0,["SMOG"]=0,["FOGGY"]=0,["XMAS"]=0,["SNOWLIGHT"]=0,["BLIZZARD"]=0}local o=0.0;local p=0.005;local q=0.02;Citizen.CreateThread(function()while true do if k then CMG.DrawText(o+0.265,0.96,"Time Left:",0.3,4,1,{0,208,104,255})CMG.DrawText(o+0.295,0.96,tostring(m),0.3,0,1,{255,74,53,255})CMG.DrawText(o+0.29,0.827,"Weather Voter",0.3,4,1,{0,208,104,255})CMG.DrawText(o+0.2645,0.848,"Clear",0.3,4,1,{255,255,255,255})CMG.DrawText(o+0.2645,0.866,"ExtraSunny",0.3,4,1,{255,255,255,255})CMG.DrawText(o+0.2645,0.884,"Cloudy",0.3,4,1,{255,255,255,255})CMG.DrawText(o+0.2645,0.902,"Overcast",0.3,4,1,{255,255,255,255})CMG.DrawText(o+0.2645,0.920,"Rain",0.3,4,1,{255,255,255,255})CMG.DrawText(o+0.2645,0.938,"Thunder",0.3,4,1,{255,255,255,255})CMG.DrawText(o+p+0.293,0.848,tostring(n["CLEAR"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+p+0.293,0.866,tostring(n["EXTRASUNNY"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+p+0.293,0.884,tostring(n["CLOUDS"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+p+0.293,0.902,tostring(n["OVERCAST"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+p+0.293,0.920,tostring(n["RAIN"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+p+0.293,0.938,tostring(n["THUNDER"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+p+0.315,0.848,"Halloween",0.3,4,1,{255,255,255,255})CMG.DrawText(o+p+0.315,0.866,"Smog",0.3,4,1,{255,255,255,255})CMG.DrawText(o+p+0.315,0.884,"Snow",0.3,4,1,{255,255,255,255})CMG.DrawText(o+p+0.315,0.902,"Blizzard",0.3,4,1,{255,255,255,255})CMG.DrawText(o+p+0.315,0.920,"Snowlight",0.3,4,1,{255,255,255,255})CMG.DrawText(o+p+0.315,0.938,"Foggy",0.3,4,1,{255,255,255,255})CMG.DrawText(o+q+0.333,0.848,tostring(n["HALLOWEEN"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+q+0.333,0.866,tostring(n["SMOG"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+q+0.333,0.884,tostring(n["XMAS"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+q+0.333,0.902,tostring(n["BLIZZARD"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+q+0.333,0.920,tostring(n["SNOWLIGHT"]),0.25,0,1,{255,74,53,255})CMG.DrawText(o+q+0.333,0.938,tostring(n["FOGGY"]),0.25,0,1,{255,74,53,255})end;Wait(0)end end)Citizen.CreateThread(function()while true do if k then m=m-1;if m==0 then k=false;m=60;l=false;resetVotes()end end;Wait(1000)end end)function voteWeather(r)if k then if not l then TriggerServerEvent("CMG:vote",r)l=true;tvRP.notify("~g~Vote sent!")else tvRP.notify("~r~You have already voted!")end else tvRP.notify("~r~Vote not in progress, start a vote with /voteweather!")end end;function resetVotes()n={["CLEAR"]=0,["EXTRASUNNY"]=0,["CLOUDS"]=0,["OVERCAST"]=0,["RAIN"]=0,["THUNDER"]=0,["HALLOWEEN"]=0,["SMOG"]=0,["FOGGY"]=0,["XMAS"]=0,["SNOWLIGHT"]=0,["BLIZZARD"]=0}end;RegisterNetEvent("CMG:startWeatherVote",function()if not CMG.inEvent()then k=true;TriggerEvent("chatMessage","Weather vote has started! Type /[weather] e.g /snow or /rain to vote.",{0,250,50})TriggerEvent("chatMessage","Weather types are in bottom left & /voteweather to start a vote",{0,250,50})end end)RegisterNetEvent("CMG:voteStateChange",function(s)n[s]=n[s]+1 end)RegisterCommand("voteweather",function()TriggerServerEvent("CMG:tryStartWeatherVote")end,false)RegisterCommand("clear",function()voteWeather("CLEAR")end,false)RegisterCommand("extrasunny",function()voteWeather("EXTRASUNNY")end,false)RegisterCommand("cloudy",function()voteWeather("CLOUDS")end,false)RegisterCommand("overcast",function()voteWeather("OVERCAST")end,false)RegisterCommand("rain",function()voteWeather("RAIN")end,false)RegisterCommand("thunder",function()voteWeather("THUNDER")end,false)RegisterCommand("halloween",function()voteWeather("HALLOWEEN")end,false)RegisterCommand("smog",function()voteWeather("SMOG")end,false)RegisterCommand("foggy",function()voteWeather("FOGGY")end,false)RegisterCommand("snow",function()voteWeather("XMAS")end,false)RegisterCommand("snowlight",function()voteWeather("SNOWLIGHT")end,false)RegisterCommand("blizzard",function()voteWeather("BLIZZARD")end,false)