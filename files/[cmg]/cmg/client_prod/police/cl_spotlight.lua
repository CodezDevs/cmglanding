local a="spotlight"local b=false;local c={}function ShowNotification(d)BeginTextCommandThefeedPost("STRING")AddTextComponentSubstringPlayerName(d)EndTextCommandThefeedPostTicker(false,false)end;function DisplayHelp(d)BeginTextCommandDisplayHelp("STRING")AddTextComponentSubstringPlayerName(d)EndTextCommandDisplayHelp(0,0,1,-1)end;function getVehicleSpotlightStatus(e)for f,g in ipairs(c)do if g[1]==e then return f end end;return false end;RegisterNetEvent("spotlight:syncSpotlights",function(h)c=h end)Citizen.CreateThread(function()TriggerServerEvent("spotlight:syncSpotlights")end)RegisterCommand(a,function(i,j,k)local l=CMG.getPlayerPed()local m=GetVehiclePedIsIn(l,false)if IsPedInAnyVehicle(l,false)then if b then if GetVehicleClass(m)~=18 then return ShowNotification("~r~Invalid permissions.")end end;local n=VehToNet(m)local o=GetEntityForwardVector(m)TriggerServerEvent("spotlight:toggleSpotlight",n,{o.x,o.y,o.z})local p=getVehicleSpotlightStatus(n)if p==false then ShowNotification("Spotlight toggled ~g~on~w~.")else ShowNotification("Spotlight toggled ~r~off~w~.")Wait(300)DisplayHelp("Spotlight is ~r~off~w~.")end else ShowNotification("~y~You are not in a vehicle.")end end)Citizen.CreateThread(function()while true do Citizen.Wait(1)for f,q in ipairs(c)do local l=CMG.getPlayerPed()local r=NetToVeh(q[1])local s=GetEntityBoneIndexByName(r,"door_dside_f")local t=GetEntityBoneIndexByName(r,"windscreen")local u=GetWorldPositionOfEntityBone(r,s)local v=GetWorldPositionOfEntityBone(r,t)local w=GetEntityCoords(CMG.getPlayerPed(),true)local x=vector3(q[2][1],q[2][2],q[2][3])if not NetworkDoesEntityExistWithNetworkId(q[1])then TriggerServerEvent("spotlight:toggleSpotlight",q[1],{0,0,0})return end;if GetVehiclePedIsIn(l,false)==r then local y=0;local z=0;local A=GetEntityForwardVector(r)local B=GetEntityHeading(r)if IsControlPressed(0,127)then z=z+0.1 end;if IsControlPressed(0,126)then z=z-0.1 end;if IsControlPressed(0,124)then if B>=180 and B<=365 then y=y+0.1 else y=y-0.1 end end;if IsControlPressed(0,125)then if B>=180 and B<=365 then y=y-0.1 else y=y+0.1 end end;TriggerServerEvent("spotlight:updateSpotlight",f,{A.x,x.y+y,x.z+z})DisplayHelp("Spotlight is ~g~on~w~.")end;DrawSpotLight(u.x,v.y,u.z,x.x,x.y,x.z,221,221,221,70.0,50.0,4.3,25.0,28.6)end end end)