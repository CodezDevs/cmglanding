local a=0;local b=0;local c=-1;local d=-1;local e=false;local f=nil;local g=0;function CMG.isUsingPoliceRobot()return a~=0 end;local function h(i)ScaleformMovieMethodAddParamPlayerNameString(i)end;local function j(k)BeginTextCommandScaleformString("STRING")AddTextComponentSubstringKeyboardDisplay(k)EndTextCommandScaleformString()end;local function l()d=RequestScaleformMovie("instructional_buttons")while not HasScaleformMovieLoaded(d)do Citizen.Wait(0)end;BeginScaleformMovieMethod(d,"CLEAR_ALL")EndScaleformMovieMethod()BeginScaleformMovieMethod(d,"SET_CLEAR_SPACE")ScaleformMovieMethodAddParamInt(200)EndScaleformMovieMethod()BeginScaleformMovieMethod(d,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(1)h(GetControlInstructionalButton(0,121,true))j("Camera Stream")EndScaleformMovieMethod()BeginScaleformMovieMethod(d,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(2)h(GetControlInstructionalButton(0,178,true))j("Thermal Vision")EndScaleformMovieMethod()BeginScaleformMovieMethod(d,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(3)h(GetControlInstructionalButton(0,175,true))j("Right")EndScaleformMovieMethod()BeginScaleformMovieMethod(d,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(4)h(GetControlInstructionalButton(0,174,true))j("Left")EndScaleformMovieMethod()BeginScaleformMovieMethod(d,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(5)h(GetControlInstructionalButton(0,173,true))j("Backwards")EndScaleformMovieMethod()BeginScaleformMovieMethod(d,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(6)h(GetControlInstructionalButton(0,172,true))j("Forward")EndScaleformMovieMethod()BeginScaleformMovieMethod(d,"DRAW_INSTRUCTIONAL_BUTTONS")EndScaleformMovieMethod()BeginScaleformMovieMethod(d,"SET_BACKGROUND_COLOUR")ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(80)EndScaleformMovieMethod()end;RegisterNetEvent("CMG:policeRobotCreate",function()local m=PlayerPedId()local n=GetEntityCoords(m,true)+GetEntityForwardVector(m)*2.0;local o=GetEntityHeading(m)a=CMG.spawnVehicle(`policerobot`,n.x,n.y,n.z,o,false,true,true)SetVehicleDoorsLocked(a,2)SetVehicleDoorsLockedForAllPlayers(a,true)CMG.loadModel(`s_m_m_bouncer_01`)local p=CreatePedInsideVehicle(a,0,`s_m_m_bouncer_01`,-1,true,true)SetModelAsNoLongerNeeded(`s_m_m_bouncer_01`)SetEntityCanBeDamaged(p,false)SetEntityInvincible(p,true)SetEntityVisible(p,false,false)FreezeEntityPosition(p,true)SetPedAlertness(p,0.0)SetBlockingOfNonTemporaryEvents(p,true)l()while not NetworkGetEntityIsNetworked(a)or NetworkGetNetworkIdFromEntity(a)==0 do Citizen.Wait(0)end;Citizen.Wait(1000)b=NetworkGetNetworkIdFromEntity(a)TriggerServerEvent("CMG:policeRobotCreate",b)end)local function q(r,s,t)local u=t and 200 or 1;local p=GetPedInVehicleSeat(s,-1)if r=="forward"then TaskVehicleTempAction(p,s,9,u)elseif r=="brake"then TaskVehicleTempAction(p,s,6,2500)elseif r=="reverse"then TaskVehicleTempAction(p,s,22,u)elseif r=="rightReverse"then TaskVehicleTempAction(p,s,13,u)elseif r=="leftReverse"then TaskVehicleTempAction(p,s,14,u)elseif r=="burnout"then TaskVehicleTempAction(p,s,30,t and 200 or 100)elseif r=="leftForward"then TaskVehicleTempAction(p,s,7,u)elseif r=="rightForward"then TaskVehicleTempAction(p,s,8,u)elseif r=="rotateLeft"then TaskVehicleTempAction(p,s,4,u)elseif r=="rotateRight"then TaskVehicleTempAction(p,s,5,u)end end;RegisterNetEvent("CMG:policeRobotEvent",function(r,v)if NetworkDoesEntityExistWithNetworkId(v)then local s=NetworkGetEntityFromNetworkId(v)if s~=0 and NetworkHasControlOfEntity(s)then q(r,s,true)end end end)local function w(r)if NetworkHasControlOfEntity(a)then q(r,a,false)else local x=GetGameTimer()if x-g>150 or f~=r then TriggerServerEvent("CMG:policeRobotEvent",r)f=r;g=x end end end;local function y()if c==-1 then c=CreateCam("DEFAULT_SCRIPTED_CAMERA",true)AttachCamToEntity(c,a,-0.3,0.0,0.5,true)SetCamActive(c,true)RenderScriptCams(true,true,0,true,true)SetTimecycleModifier("scanline_cam_cheap")SetTimecycleModifierStrength(1.0)else ClearTimecycleModifier()SetSeethrough(false)RenderScriptCams(false,false,0,false,false)SetCamActive(c,false)DestroyCam(c,false)c=-1;e=false end end;RegisterNetEvent("CMG:policeRobotDelete",function()if c~=-1 then y()end;if d~=-1 then SetScaleformMovieAsNoLongerNeeded(d)d=-1 end;a=0;b=0 end)local function z()if a==0 then return end;if not DoesEntityExist(a)then if c~=-1 then y()elseif NetworkDoesEntityExistWithNetworkId(b)then a=NetworkGetEntityFromNetworkId(b)end;return end;if IsControlPressed(0,172)and not IsControlPressed(0,173)then w("forward")end;if IsControlJustReleased(0,172)or IsControlJustReleased(0,173)then w("brake")end;if IsControlPressed(0,173)and not IsControlPressed(0,172)then w("reverse")end;if IsControlPressed(0,174)and IsControlPressed(0,173)then w("rightReverse")end;if IsControlPressed(0,175)and IsControlPressed(0,173)then w("rightReverse")end;if IsControlPressed(0,172)and IsControlPressed(0,173)then w("burnout")end;if IsControlPressed(0,174)and IsControlPressed(0,172)then w("leftForward")end;if IsControlPressed(0,175)and IsControlPressed(0,172)then w("rightForward")end;if IsControlPressed(0,174)and not IsControlPressed(0,172)and not IsControlPressed(0,173)then w("rotateLeft")end;if IsControlPressed(0,175)and not IsControlPressed(0,172)and not IsControlPressed(0,173)then w("rotateRight")end;if IsControlJustPressed(0,121)then y()end;if c~=-1 then local A=GetEntityRotation(a)SetCamRot(c,A.x,A.y,A.z,2)if IsControlJustPressed(0,178)then e=not e;if e then SetSeethrough(true)else SetSeethrough(false)end end end;DrawScaleformMovieFullscreen(d,255,255,255,255,0)end;CMG.createThreadOnTick(z)