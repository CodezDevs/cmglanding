TriggerEvent('chat:addSuggestion','/setuparch','Setup a knife arch')TriggerEvent('chat:addSuggestion','/removearch','Remove a knife arch')local a={}local b=false;RegisterNetEvent("CMG:createArch",function()local c=CMG.loadModel(`ch_prop_ch_metal_detector_01a`)local d=CMG.getPlayerPed()local e=CMG.getPlayerCoords()local f=GetGroundZFor_3dCoord(e.x,e.y,e.z,0)local g=CreateObject(c,e.x,e.y,e.z-1.0,true,true,true)PlaceObjectOnGroundProperly(g)FreezeEntityPosition(g,true)CMG.syncNetworkId(networkId)SetEntityHeading(g,GetEntityHeading(d))SetModelAsNoLongerNeeded(c)local h=GetGameTimer()while true do if GetGameTimer()-h>5000 then DeleteEntity(g)return elseif NetworkGetEntityIsNetworked(g)and NetworkGetNetworkIdFromEntity(g)~=0 then break end;Citizen.Wait(200)end;local networkId=NetworkGetNetworkIdFromEntity(g)tvRP.notify("~g~Success! ~w~Knife Arch setup.")TriggerServerEvent("CMG:serverAddArch",e,networkId)end)RegisterNetEvent("CMG:deleteArch",function()for i,j in pairs(a)do if#(j[1]-CMG.getPlayerCoords())<=5.0 then local k=j[2]local l=CMG.getObjectId(j[2])Citizen.Trace(l)TriggerServerEvent("CMG:serverRemoveArch",k)SetEntityVisible(l,false)DeleteEntity(l)tvRP.notify("~g~Success! ~w~Knife Arch removed.")break end end end)RegisterNetEvent("CMG:archActivated",function(e,m)local n=CMG.getPlayerCoords()if#(n-e)<=20.0 then SendNUIMessage({transactionType='knifeArch'})end end)RegisterNetEvent("CMG:syncKnifeArchTable",function(o)a=o;b=true end)RegisterNetEvent("CMG:addArch",function(e,p)a[p]={e,p}local q=table.count(a)if q>0 then b=true end end)RegisterNetEvent("CMG:removeArch",function(p)a[p]=nil;if table.count(a)<1 then b=false end end)local r=0;Citizen.CreateThread(function()while true do if b then local e=CMG.getPlayerCoords()for s,j in pairs(a)do local t=j[1]if#(t-e)<=1.6 then local u=0;if HasPedGotWeapon(PlayerPedId(),`GADGET_PARACHUTE`,false)then u=1 end;if table.count(CMG.getWeapons())>u then TriggerServerEvent("CMG:serverArchActivated",e)Wait(3000)break end;local v=GetGameTimer()if v-r>5000 then TriggerServerEvent("CMG:knifeArchCheckInventory",e)r=v end end end end;Wait(350)end end)TriggerServerEvent("CMG:requestKnifeArchTableSync",a)