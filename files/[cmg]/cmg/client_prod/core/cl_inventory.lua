drawInventoryUI=false;local a=false;local b=false;local c=false;local d=0.00;local e=0.00;local f=nil;local g=nil;local h=nil;local i=false;local j=nil;local k=0;local l=0;local function m()if IsUsingKeyboard(2)and not tvRP.isInComa()and not tvRP.isHandcuffed()then if not i then drawInventoryUI=not drawInventoryUI;if drawInventoryUI then setCursor(1)else setCursor(0)TriggerEvent("CMG:clCloseTrunk")inGUICMG=false end else tvRP.notify("~r~Cannot open inventory right before a restart!")end end end;RegisterCommand("inventory",m,false)RegisterKeyMapping("inventory","Open Inventory","KEYBOARD","L")Citizen.CreateThread(function()while true do if drawInventoryUI and IsDisabledControlJustReleased(0,200)then m()end;Wait(0)end end)CMGItemList={}CMGSecondItemList={}function CMG.getSpaceInFirstChest()local n=0;for o,p in pairs(CMGItemList)do n=n+p[3]*p[2]end;return d-n end;function CMG.getSpaceInSecondChest()local n=0;for o,p in pairs(CMGSecondItemList)do n=n+p[3]*p[2]end;return e-n end;RegisterNetEvent("CMG:sendInventoryData",function(q,r)CMGItemList=q;d=r;if CMGItemList["dirtycash"]then TriggerEvent("CMG:setDisplayRedMoney",CMGItemList["dirtycash"][2])else TriggerEvent("CMG:setDisplayRedMoney",0)end end)RegisterNetEvent("CMG:getSecondInventoryData",function(q,r,s)CMGSecondItemList=q;e=r;c=true;drawInventoryUI=true;setCursor(1)if s then g=s;h=GetEntityCoords(CMG.getPlayerPed())if s=="notmytrunk"then j=GetEntityCoords(CMG.getPlayerPed())end;if string.match(s,"player_")then l=string.gsub(s,"player_","")else l=0 end end end)RegisterNetEvent("CMG:closeToRestart",function(q)i=true;Citizen.CreateThread(function()while true do CMGSecondItemList={}c=false;drawInventoryUI=false;setCursor(0)Wait(50)end end)end)RegisterNetEvent("CMG:closeSecondInventory",function()CMGSecondItemList={}c=false;drawInventoryUI=false;g=nil;setCursor(0)end)AddEventHandler("CMG:clCloseTrunk",function()c=false;drawInventoryUI=false;g=nil;setCursor(0)f=nil;inGUICMG=false end)AddEventHandler("CMG:clOpenTrunk",function()local t=tvRP.getNearestVehicle(6)if t then local u=GetEntityModel(t)local v=nil;for w,x in pairs(globalVehicleModelHashMapping)do if w==u then v=x end end;if v then local y,z=tvRP.getVehicleInfos(t)if y==CMG.getUserId()and z==v then c=true;drawInventoryUI=true;setCursor(1)f=t;print("[CMG Trunks] calling OpenVehicleTrunk: "..tostring(globalVehicleModelHashMapping[u]))vRPserver.OpenVehicleTrunk({globalVehicleModelHashMapping[u]})else tvRP.notify("~r~You don't have the keys to this vehicle")end else tvRP.notify("~r~You don't have the keys to this vehicle!")end else tvRP.notify("~r~No vehicle nearby")end end)Citizen.CreateThread(function()while true do if f~=nil and c then local A=GetEntityCoords(CMG.getPlayerPed())local B=GetEntityCoords(f)local C=#(A-B)if C>10.0 then TriggerEvent("CMG:clCloseTrunk")TriggerServerEvent("CMG:closeChest")end end;if g=="house"and c then local A=GetEntityCoords(CMG.getPlayerPed())local B=h;local C=#(A-B)if C>5.0 then TriggerEvent("CMG:clCloseTrunk")TriggerServerEvent("CMG:closeChest")end end;if g=="notmytrunk"and c then local A=GetEntityCoords(CMG.getPlayerPed())local B=j;local C=#(A-B)if C>5.0 then TriggerEvent("CMG:clCloseTrunk")TriggerServerEvent("CMG:closeChest")end end;if l~=0 and c then local A=GetEntityCoords(CMG.getPlayerPed())local B=GetEntityCoords(GetPlayerPed(GetPlayerFromServerId(tonumber(l))))local C=#(A-B)if C>5.0 then TriggerEvent("CMG:clCloseTrunk")TriggerServerEvent("CMG:closeChest")end end;if f==nil and g=="trunk"then c=false;drawInventoryUI=false end;Wait(500)end end)local D={["Dirty Cash"]=true}local function E(F,G)if D[F]then return"Â£"..getMoneyStringFormatted(G)else return G end end;local H={["p12guage"]=true,["p5.56"]=true,["p7.62"]=true,["p9mm"]=true,["p.308"]=true,["7.62"]=true,["5.56"]=true,["12guage"]=true,["9mm"]=true,[".357"]=true,[".45ACP"]=true,[".308"]=true}local function I()return H[a]or false end;Citizen.CreateThread(function()while true do if drawInventoryUI then DrawRect(0.5,0.53,0.572,0.508,0,0,0,150)DrawAdvancedText(0.593,0.242,0.005,0.0028,0.66,"CMG Inventory",255,255,255,255,7,0)DrawRect(0.5,0.24,0.572,0.058,0,0,0,225)DrawRect(0.342,0.536,0.215,0.436,0,0,0,150)DrawRect(0.652,0.537,0.215,0.436,0,0,0,150)if I()then DrawAdvancedText(0.575,0.364,0.005,0.0028,0.325,"Use",255,255,255,255,6,0)DrawAdvancedText(0.615,0.364,0.005,0.0028,0.325,"Use All",255,255,255,255,6,0)else DrawAdvancedText(0.594,0.364,0.005,0.0028,0.4,"Use",255,255,255,255,6,0)end;DrawAdvancedText(0.594,0.454,0.005,0.0028,0.4,"Move",255,255,255,255,6,0)DrawAdvancedText(0.575,0.545,0.005,0.0028,0.325,"Move X",255,255,255,255,6,0)DrawAdvancedText(0.615,0.545,0.005,0.0028,0.325,"Move All",255,255,255,255,6,0)DrawAdvancedText(0.595,0.634,0.005,0.0028,0.35,"Give to Nearest Player",255,255,255,255,6,0)DrawAdvancedText(0.594,0.722,0.005,0.0028,0.4,"Trash",255,255,255,255,6,0)DrawAdvancedText(0.488,0.335,0.005,0.0028,0.366,"Amount",255,255,255,255,4,0)DrawAdvancedText(0.404,0.335,0.005,0.0028,0.366,"Item Name",255,255,255,255,4,0)DrawAdvancedText(0.521,0.335,0.005,0.0028,0.366,"Weight",255,255,255,255,4,0)DrawAdvancedText(0.833,0.776,0.005,0.0028,0.288,"[Press L to close]",255,255,255,255,4,0)DrawRect(0.5,0.273,0.572,0.0069999999999999,0,50,142,150)DisableControlAction(0,200,true)inGUICMG=true;if not c then DrawAdvancedText(0.751,0.525,0.005,0.0028,0.49,"2nd Inventory not available",255,255,255,118,6,0)elseif g~=nil then DrawAdvancedText(0.798,0.335,0.005,0.0028,0.366,"Amount",255,255,255,255,4,0)DrawAdvancedText(0.714,0.335,0.005,0.0028,0.366,"Item Name",255,255,255,255,4,0)DrawAdvancedText(0.831,0.335,0.005,0.0028,0.366,"Weight",255,255,255,255,4,0)local J=0.026;local K=0.026;local L=0;local M=0;local N=sortAlphabetically(CMGSecondItemList)for O,P in pairs(N)do local w=P.title;local x=P["value"]local Q,G,n=table.unpack(x)M=M+G*n;DrawAdvancedText(0.714,0.360+L*K,0.005,0.0028,0.366,Q,255,255,255,255,4,0)DrawAdvancedText(0.831,0.360+L*K,0.005,0.0028,0.366,tostring(n*G).."kg",255,255,255,255,4,0)DrawAdvancedText(0.798,0.360+L*K,0.005,0.0028,0.366,E(Q,G),255,255,255,255,4,0)if CursorInArea(0.5443,0.7584,0.3435+L*K,0.3690+L*K)then DrawRect(0.652,0.331+J*(L+1),0.215,0.026,0,168,255,150)if IsControlJustPressed(1,329)or IsDisabledControlJustPressed(1,329)then PlaySound(-1,"SELECT","HUD_FRONTEND_DEFAULT_SOUNDSET",0,0,1)if not lockInventorySoUserNoSpam then b=w;a=false;k=G;selectedItemWeight=n;lockInventorySoUserNoSpam=true;Citizen.CreateThread(function()Wait(250)lockInventorySoUserNoSpam=false end)end end elseif w==b then DrawRect(0.652,0.331+J*(L+1),0.215,0.026,0,168,255,150)end;L=L+1 end;if M/e>0.5 then if M/e>0.9 then DrawAdvancedText(0.826,0.307,0.005,0.0028,0.366,"Weight: "..M.."/"..e.."kg",255,50,0,255,4,0)else DrawAdvancedText(0.826,0.307,0.005,0.0028,0.366,"Weight: "..M.."/"..e.."kg",255,165,0,255,4,0)end else DrawAdvancedText(0.826,0.307,0.005,0.0028,0.366,"Weight: "..M.."/"..e.."kg",255,255,153,255,4,0)end end;if I()then if CursorInArea(0.4598,0.498,0.3283,0.3848)then DrawRect(0.48,0.36,0.0375,0.056,0,168,255,150)if IsControlJustPressed(1,329)or IsDisabledControlJustPressed(1,329)then PlaySound(-1,"SELECT","HUD_FRONTEND_DEFAULT_SOUNDSET",0,0,1)if not lockInventorySoUserNoSpam then if a then vRPserver.useInventoryItem({a,false})elseif b and g~=nil and c then vRPserver.useInventoryItem({b,false})else tvRP.notify("~r~No item selected!")end end;lockInventorySoUserNoSpam=true;Citizen.CreateThread(function()Wait(250)lockInventorySoUserNoSpam=false end)end else DrawRect(0.48,0.36,0.0375,0.056,0,0,0,150)end;if CursorInArea(0.5004,0.5333,0.3283,0.3848)then DrawRect(0.52,0.36,0.0375,0.056,0,168,255,150)if IsControlJustPressed(1,329)or IsDisabledControlJustPressed(1,329)then PlaySound(-1,"SELECT","HUD_FRONTEND_DEFAULT_SOUNDSET",0,0,1)if not lockInventorySoUserNoSpam then if a then vRPserver.useInventoryItem({a,true})elseif b and g~=nil and c then vRPserver.useInventoryItem({b,true})else tvRP.notify("~r~No item selected!")end end;lockInventorySoUserNoSpam=true;Citizen.CreateThread(function()Wait(250)lockInventorySoUserNoSpam=false end)end else DrawRect(0.52,0.36,0.0375,0.056,0,0,0,150)end else if CursorInArea(0.4598,0.5333,0.3283,0.3848)then DrawRect(0.5,0.36,0.075,0.056,0,168,255,150)if IsControlJustPressed(1,329)or IsDisabledControlJustPressed(1,329)then PlaySound(-1,"SELECT","HUD_FRONTEND_DEFAULT_SOUNDSET",0,0,1)if not lockInventorySoUserNoSpam then if a then vRPserver.useInventoryItem({a,false})elseif b and g~=nil and c then vRPserver.useInventoryItem({b,false})else tvRP.notify("~r~No item selected!")end end;lockInventorySoUserNoSpam=true;Citizen.CreateThread(function()Wait(250)lockInventorySoUserNoSpam=false end)end else DrawRect(0.5,0.36,0.075,0.056,0,0,0,150)end end;if CursorInArea(0.4598,0.5333,0.418,0.4709)then DrawRect(0.5,0.45,0.075,0.056,0,168,255,150)if IsControlJustPressed(1,329)or IsDisabledControlJustPressed(1,329)then PlaySound(-1,"SELECT","HUD_FRONTEND_DEFAULT_SOUNDSET",0,0,1)if not lockInventorySoUserNoSpam then if c then if a and g~=nil and c then if CMG.getPlayerCombatTimer()>0 then notify("~r~You can not store items whilst in combat.")elseif a=="dirtycash"and CMG.isPlayerInRedZone()then notify("~r~You can not store dirty cash inside a redzone.")else vRPserver.moveClientToChest({a,1})end elseif b and g~=nil and c then vRPserver.moveChestToClient({b,1})else tvRP.notify("~r~No item selected!")end else tvRP.notify("~r~No second inventory available!")end end;lockInventorySoUserNoSpam=true;Citizen.CreateThread(function()Wait(250)lockInventorySoUserNoSpam=false end)end else DrawRect(0.5,0.45,0.075,0.056,0,0,0,150)end;if CursorInArea(0.4598,0.498,0.5042,0.5666)then DrawRect(0.48,0.54,0.0375,0.056,0,168,255,150)if IsControlJustPressed(1,329)or IsDisabledControlJustPressed(1,329)then PlaySound(-1,"SELECT","HUD_FRONTEND_DEFAULT_SOUNDSET",0,0,1)local R=tonumber(GetInvAmountText())or 1;if not lockInventorySoUserNoSpam then if c then if a and g~=nil and c then if CMG.getPlayerCombatTimer()>0 then notify("~r~You can not store items whilst in combat.")elseif a=="dirtycash"and CMG.isPlayerInRedZone()then notify("~r~You can not store dirty cash inside a redzone.")else vRPserver.moveClientToChest({a,R})end elseif b and g~=nil and c then vRPserver.moveChestToClient({b,R})else tvRP.notify("~r~No item selected!")end else tvRP.notify("~r~No second inventory available!")end end;lockInventorySoUserNoSpam=true;Citizen.CreateThread(function()Wait(250)lockInventorySoUserNoSpam=false end)end else DrawRect(0.48,0.54,0.0375,0.056,0,0,0,150)end;if CursorInArea(0.5004,0.5333,0.5042,0.5666)then DrawRect(0.52,0.54,0.0375,0.056,0,168,255,150)if IsControlJustPressed(1,329)or IsDisabledControlJustPressed(1,329)then PlaySound(-1,"SELECT","HUD_FRONTEND_DEFAULT_SOUNDSET",0,0,1)if not lockInventorySoUserNoSpam then if c then if a and g~=nil and c then local S=CMG.getSpaceInSecondChest()local R=k;if k*selectedItemWeight>S then R=math.floor(S/selectedItemWeight)end;if R>0 then if CMG.getPlayerCombatTimer()>0 then notify("~r~You can not store items whilst in combat.")elseif a=="dirtycash"and CMG.isPlayerInRedZone()then notify("~r~You can not store dirty cash inside a redzone.")else vRPserver.moveClientToChest({a,R})end else tvRP.notify("~r~Not enough space in secondary chest!")end elseif b and g~=nil and c then local T=CMG.getSpaceInFirstChest()local R=k;if k*selectedItemWeight>T then R=math.floor(T/selectedItemWeight)end;if R>0 then vRPserver.moveChestToClient({b,R})else tvRP.notify("~r~Not enough space in secondary chest!")end else tvRP.notify("~r~No item selected!")end else tvRP.notify("~r~No second inventory available!")end end;lockInventorySoUserNoSpam=true;Citizen.CreateThread(function()Wait(250)lockInventorySoUserNoSpam=false end)end else DrawRect(0.52,0.54,0.0375,0.056,0,0,0,150)end;if CursorInArea(0.4598,0.5333,0.5931,0.6477)then DrawRect(0.5,0.63,0.075,0.056,0,168,255,150)if IsControlJustPressed(1,329)or IsDisabledControlJustPressed(1,329)then PlaySound(-1,"SELECT","HUD_FRONTEND_DEFAULT_SOUNDSET",0,0,1)if not lockInventorySoUserNoSpam then if a then vRPserver.giveToNearestPlayer({a})elseif b then vRPserver.giveToNearestPlayer({b})else tvRP.notify("~r~No item selected!")end end;lockInventorySoUserNoSpam=true;Citizen.CreateThread(function()Wait(250)lockInventorySoUserNoSpam=false end)end else DrawRect(0.5,0.63,0.075,0.056,0,0,0,150)end;if CursorInArea(0.4598,0.5333,0.6831,0.7377)then DrawRect(0.5,0.72,0.075,0.056,0,168,255,150)if IsControlJustPressed(1,329)or IsDisabledControlJustPressed(1,329)then PlaySound(-1,"SELECT","HUD_FRONTEND_DEFAULT_SOUNDSET",0,0,1)if not lockInventorySoUserNoSpam then if a then vRPserver.trashItem({a})elseif b then tvRP.notify("~r~Please move the item to your inventory to trash")else tvRP.notify("~r~No item selected!")end end;lockInventorySoUserNoSpam=true;Citizen.CreateThread(function()Wait(250)lockInventorySoUserNoSpam=false end)end else DrawRect(0.5,0.72,0.075,0.056,0,0,0,150)end;local J=0.026;local K=0.026;local L=0;local M=0;local N=sortAlphabetically(CMGItemList)for O,P in pairs(N)do local w=P.title;local x=P["value"]local Q,G,n=table.unpack(x)M=M+G*n;DrawAdvancedText(0.404,0.360+L*K,0.005,0.0028,0.366,Q,255,255,255,255,4,0)DrawAdvancedText(0.521,0.360+L*K,0.005,0.0028,0.366,tostring(n*G).."kg",255,255,255,255,4,0)DrawAdvancedText(0.488,0.360+L*K,0.005,0.0028,0.366,E(Q,G),255,255,255,255,4,0)if CursorInArea(0.2343,0.4484,0.3435+L*K,0.3690+L*K)then DrawRect(0.342,0.331+J*(L+1),0.215,0.026,0,168,255,150)if IsControlJustPressed(1,329)or IsDisabledControlJustPressed(1,329)then PlaySound(-1,"SELECT","HUD_FRONTEND_DEFAULT_SOUNDSET",0,0,1)a=w;k=G;selectedItemWeight=n;b=false end elseif w==a then DrawRect(0.342,0.331+J*(L+1),0.215,0.026,0,168,255,150)end;L=L+1 end;if M/d>0.5 then if M/d>0.9 then DrawAdvancedText(0.516,0.307,0.005,0.0028,0.366,"Weight: "..M.."/"..d.."kg",255,50,0,255,4,0)else DrawAdvancedText(0.516,0.307,0.005,0.0028,0.366,"Weight: "..M.."/"..d.."kg",255,165,0,255,4,0)end else DrawAdvancedText(0.516,0.307,0.005,0.0028,0.366,"Weight: "..M.."/"..d.."kg",255,255,255,255,4,0)end end;Wait(0)end end)Citizen.CreateThread(function()while true do if GetEntityHealth(CMG.getPlayerPed())<=102 then CMGSecondItemList={}c=false;drawInventoryUI=false;inGUICMG=false;setCursor(0)end;Wait(50)end end)function GetInvAmountText()AddTextEntry('FMMC_MPM_NA',"Enter amount: (Blank to cancel)")DisplayOnscreenKeyboard(1,"FMMC_MPM_NA","Enter amount: (Blank to cancel)","","","","",30)while UpdateOnscreenKeyboard()==0 do DisableAllControlActions(0)Wait(0)end;if GetOnscreenKeyboardResult()then local U=GetOnscreenKeyboardResult()return U end;return nil end;function openGui()SetNuiFocus(false)SendNUIMessage({openNUI=true})end;function closeGui()SetNuiFocus(false)SendNUIMessage({openNUI=false})end;local V=0;local W=0;RegisterNetEvent("CMG:placeHeadBag",function()W=W+1;if W%2~=0 then local X=CMG.getPlayerPed()V=CreateObject(`prop_money_bag_01`,0,0,0,true,true,true)AttachEntityToEntity(V,X,GetPedBoneIndex(X,12844),0.2,0.04,0,0,270.0,60.0,true,true,false,true,1,true)openGui()else DeleteEntity(V)closeGui()end end)