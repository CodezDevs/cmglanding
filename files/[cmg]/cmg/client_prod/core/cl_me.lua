local a={}local b=0.1;local c=false;local d={0,168,255,215}local function e(f,g,h,i,j)if not a[i]then a[i]={}end;table.insert(a[i],{type=f,msg=g,color=h})SetTimeout(j,function()table.remove(a[i],1)if#a[i]==0 then a[i]=nil end end)end;local function k()for l,m in pairs(a)do if GetVehiclePedIsUsing(l)==0 then local n=GetEntityCoords(l)for o,p in pairs(a[l])do local q=n+vector3(0.0,0.0,0.9+b*o)CMG.DrawText3D(q,p.msg,0.5,4,false,p.color)end else local r=GetEntityBoneIndexByName(l,"IK_Head")local s=GetWorldPositionOfEntityBone(l,r)for o,p in pairs(a[l])do local q=s+vector3(0.0,0.0,0.4+b*o)CMG.DrawText3D(q,p.msg,0.5,4,false,p.color)end end end end;CMG.createThreadOnTick(k)RegisterNetEvent("CMG:sendLocalChat",function(t,u,v)local w=GetPlayerFromServerId(t)if w~=-1 then if GetPlayerFromServerId(t)==PlayerId()then if c then TriggerEvent('chatMessage',"",{255,0,0}," ^6 me | "..u.."  ".."^6  "..v)end;e('me',v,d,CMG.getPlayerPed(),10000)elseif#(GetEntityCoords(CMG.getPlayerPed())-GetEntityCoords(GetPlayerPed(w)))<7.01 and HasEntityClearLosToEntity(CMG.getPlayerPed(),GetPlayerPed(w),17)==1 then if c then TriggerEvent('chatMessage',"",{255,0,0}," ^6 me | "..u.."  ".."^6  "..v)end;e('me',v,d,GetPlayerPed(w),10000)end end end)