local a=module("cfg/weapons")local b=false;local c;local d;local e={name="",price="",model="",priceString="",ammoPrice="",weaponShop=""}local f;local g;local h=""local i=false;local j={["Legion"]={_config={{vector3(-3171.5241699219,1087.5402832031,19.838747024536),vector3(-330.56484985352,6083.6059570312,30.454759597778)},154,1,"B&Q Tool Shop",{""},true}},["SmallArmsDealer"]={_config={{vector3(2437.5708007813,4966.5610351563,41.34761428833),vector3(-1500.4978027344,-216.72758483887,46.889373779297),vector3(1243.0490722656,-427.33932495117,67.918403625488)},110,1,"Small Arms Dealer",{""},true}},["LargeArmsDealer"]={_config={{vector3(-1108.3199462891,4934.7392578125,217.35540771484),vector3(5065.6201171875,-4591.3857421875,1.8652405738831)},110,1,"Large Arms Dealer",{"gang.whitelisted"},false}},["VIP"]={_config={{vector3(-2151.5739746094,5191.2548828125,14.718822479248)},110,5,"VIP Gun Store",{"vip.gunstore"},true}},["Rebel"]={_config={{vector3(1545.2521972656,6331.5615234375,23.07857131958),vector3(4925.6259765625,-5243.0908203125,1.524599313736)},110,5,"Rebel Gun Store",{"rebellicense.whitelisted"},true}},["SOA"]={_config={{vector3(884.88403320313,-2102.8974609375,34.591907501221)},110,5,"SOA Gun Room",{"soa2.whitelisted"},false}},["policeSmallArms"]={_config={{vector3(461.53082275391,-979.35876464844,29.689668655396),vector3(1842.9096679688,3690.7692871094,33.267082214355),vector3(-448.93994140625,6015.4150390625,31.716398239136),vector3(638.55255126953,2.7499871253967,43.423725128174),vector3(-1104.5264892578,-821.70153808594,13.282785415649)},110,5,"MET Police Small Arms",{"police.onduty.permission"},false,true}},["policeLargeArms"]={_config={{vector3(1840.6104736328,3691.4741210938,33.350730895996),vector3(461.43179321289,-982.66412353516,29.689668655396),vector3(-449.9557800293,6016.5454101563,31.716398239136),vector3(640.8759765625,-0.63530212640762,43.423385620117),vector3(-1102.5059814453,-820.62091064453,13.282785415649)},110,5,"MET Police Large Arms",{"police.loadshop2","police.onduty.permission"},false,true}},["prisonArmoury"]={_config={{vector3(1779.3741455078,2542.5639648438,45.797782897949)},110,5,"Prison Armoury",{"prisonguard.onduty.permission"},false,true}},["CMGTrader"]={_config={{vector3(1188.5987548828,-3310.4619140625,4.5154514312744)},110,5,"CMG Trader Gun Room",{"cmgtrader.whitelisted"},false}}}RMenu.Add("cmggunstore","mainmenu",RageUI.CreateMenu("","",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_gunstoreui","cmg_gunstoreui"))RMenu:Get("cmggunstore","mainmenu"):SetSubtitle("~b~GUNSTORE")RMenu.Add("cmggunstore","type",RageUI.CreateSubMenu(RMenu:Get("cmggunstore","mainmenu"),"","~b~Purchase Weapon or Ammo",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_gunstoreui","cmg_gunstoreui"))RMenu.Add("cmggunstore","confirm",RageUI.CreateSubMenu(RMenu:Get("cmggunstore","type"),"","~b~Purchase confirm your purchase",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_gunstoreui","cmg_gunstoreui"))RMenu.Add("cmggunstore","vip",RageUI.CreateSubMenu(RMenu:Get("cmggunstore","mainmenu"),"","~b~Purchase Weapon or Ammo",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_gunstoreui","cmg_gunstoreui"))RageUI.CreateWhile(1.0,RMenu:Get("cmggunstore","mainmenu"),nil,function()RageUI.IsVisible(RMenu:Get("cmggunstore","mainmenu"),true,true,true,function()i=false;if c~=nil and j~=nil then if CMG.isPlatClub()then if c=="VIP"then RageUI.ButtonWithStyle("~y~[Platinum Large Arms]","",{RightLabel="→→→"},true,function(k,l,m)if k then end;if l then end;if m then end end,RMenu:Get("cmggunstore","vip"))end end;for n,o in pairs(j)do if c==n then for p,q in pairs(sortedKeys(o))do local r=o[q]if q~="_config"then local s,t,u,v,w,x=table.unpack(r)local y=false;local z;if q=="item|fillUpArmour"then local A=GetPedArmour(CMG.getPlayerPed())local B=100-A;z=B*1000;y=true end;local C=""if y then C=tostring(getMoneyStringFormatted(z))else C=tostring(getMoneyStringFormatted(t))end;RageUI.ButtonWithStyle(s,"£"..C,{RightLabel="→→→"},true,function(k,l,m)if k then end;if l then f=q end;if m then e.name=s;e.priceString=C;e.model=q;e.price=t;e.ammoPrice=u;e.weaponShop=n end end,RMenu:Get("cmggunstore","type"))end end end end end end,function()end)RageUI.IsVisible(RMenu:Get("cmggunstore","type"),true,true,true,function()RageUI.ButtonWithStyle("Purchase Weapon Body","£"..getMoneyStringFormatted(e.price),{RightLabel="→→→"},true,function(k,l,m)if k then end;if l then end;if m then h="body"end end,RMenu:Get("cmggunstore","confirm"))if not a.weapons[e.model]or a.weapons[e.model].ammo~="modelammo"then RageUI.ButtonWithStyle("Purchase Weapon Ammo (Max)","£"..getMoneyStringFormatted(math.floor(e.price/2)),{RightLabel="→→→"},true,function(k,l,m)if k then end;if l then end;if m then h="ammo"end end,RMenu:Get("cmggunstore","confirm"))end end,function()end)RageUI.IsVisible(RMenu:Get("cmggunstore","confirm"),true,true,true,function()RageUI.ButtonWithStyle("Yes","",{RightLabel="→→→"},true,function(k,l,m)if k then end;if l then end;if m then if string.sub(e.model,1,4)=="item"then TriggerServerEvent("CMG:buyWeapon",e.model,e.price,e.name,e.weaponShop,"armour")else if h=="ammo"then if HasPedGotWeapon(CMG.getPlayerPed(),GetHashKey(e.model),false)then TriggerServerEvent("CMG:buyWeapon",e.model,e.price,e.name,e.weaponShop,"ammo")else tvRP.notify("~r~You do not have the body of this weapon to purchase ammo.")end else TriggerServerEvent("CMG:buyWeapon",e.model,e.price,e.name,e.weaponShop,"weapon",i)end end end end,RMenu:Get("cmggunstore","confirm"))RageUI.ButtonWithStyle("No","",{RightLabel="→→→"},true,function(k,l,m)if k then end;if l then end;if m then end end,RMenu:Get("cmggunstore","mainmenu"))end,function()end)RageUI.IsVisible(RMenu:Get("cmggunstore","vip"),true,true,true,function()local D=j["LargeArmsDealer"]for p,q in pairs(sortedKeys(D))do i=true;local r=D[q]if q~="_config"then local s,t,u,v,w,x=table.unpack(r)local y=false;local z;if q=="item|fillUpArmour"then local A=GetPedArmour(CMG.getPlayerPed())local B=100-A;z=B*1000;y=true end;local C=""if y then C=tostring(getMoneyStringFormatted(z))else C=tostring(getMoneyStringFormatted(t))end;RageUI.ButtonWithStyle(s,"£"..C,{RightLabel="→→→"},true,function(k,l,m)if k then end;if l then f=q end;if m then e.name=s;e.priceString=C;e.model=q;e.price=t;e.ammoPrice=u;e.weaponShop="LargeArmsDealer"end end,RMenu:Get("cmggunstore","type"))end end end,function()end)end)AddEventHandler("CMG:onClientSpawn",function(E,F)if F then TriggerServerEvent("CMG:requestNewGunshopData")end end)RegisterNetEvent("CMG:refreshGunStorePermissions",function()TriggerServerEvent("CMG:requestNewGunshopData")end)local G=false;RegisterNetEvent("CMG:recieveFilteredGunStoreData",function(H)j=H;for p,o in pairs(H)do if o["WEAPON_MP5CMG"]then G=true end end end)RegisterNetEvent("CMG:recalculateLargeArms",function(I)for n,o in pairs(j)do if n=="LargeArmsDealer"then for s,J in pairs(o)do if s~="_config"then local K=j[n][s][7]j[n][s][2]=K*(1+I/100)end end end end end)local function L(n,M)c=n;d=M;if n=="Rebel"then RMenu:Get('cmggunstore','mainmenu'):SetSpriteBanner("cmg_rebel","cmg_rebel")else RMenu:Get('cmggunstore','mainmenu'):SetSpriteBanner("cmg_gunstoreui","cmg_gunstoreui")end;RageUI.CloseAll()RageUI.Visible(RMenu:Get('cmggunstore','mainmenu'),true)end;local function N(n)c=nil;d=nil;f=nil;RageUI.CloseAll()RageUI.Visible(RMenu:Get('cmggunstore','mainmenu'),false)end;Citizen.CreateThread(function()while true do if f and g~=f then g=f;for n,o in pairs(j)do local J=o[g]if J then local w=J[5]if w and d then local O=o._config[1][d]if i then O=vector3(-2151.5739746094,5191.2548828125,14.718822479248)end;local P=CMG.loadModel(w)if O then local Q=CreateObject(P,O.x,O.y,O.z+1,false,false,false)while g==f and DoesEntityExist(Q)do SetEntityHeading(Q,GetEntityHeading(Q)+1%360)Wait(0)end;DeleteEntity(Q)end;SetModelAsNoLongerNeeded(P)end end end end;local R=PlayerPedId()if not G and GetSelectedPedWeapon(R)==`WEAPON_MP5CMG`then CMG.setWeapon(R,`WEAPON_UNARMED`,true)end;Wait(0)end end)RegisterNetEvent("CMG:onClientSpawn",function(E,F)if F then for n,o in pairs(j)do local S,T,U,V,v,W=table.unpack(o["_config"])for M,X in pairs(S)do if W then tvRP.addBlip(X.x,X.y,X.z,T,U,V)end;tvRP.addMarker(X.x,X.y,X.z,1.0,1.0,1.0,255,0,0,170,50,27)local Y=function()if GetVehiclePedIsIn(CMG.getPlayerPed(),false)==0 then L(n,M)else tvRP.notify("~r~Exit your vehicle to access the gun store.")end end;local Z=function()N(n)end;local _=function()end;CMG.createArea("gunstore_"..n.."_"..M,X,1.5,6,Y,Z,_)end end end end)local a0={}function CMG.createGunStore(a1,a2,a3)local Y=function()if GetVehiclePedIsIn(CMG.getPlayerPed(),false)==0 then L(a2)else tvRP.notify("~r~Exit your vehicle to access the gun store.")end end;local Z=function()N(a2)end;local a4=string.format("gunstore_%s_%s",a2,a1)CMG.createArea(a4,a3,1.5,6,Y,Z,function()end)local a5=tvRP.addMarker(a3.x,a3.y,a3.z,1.0,1.0,1.0,255,0,0,170,50,27)a0[a1]={area=a4,marker=a5}end;function CMG.deleteGunStore(a1)local a6=a0[a1]if a6 then tvRP.removeMarker(a6.marker)tvRP.removeArea(a6.area)a0[a1]=nil end end