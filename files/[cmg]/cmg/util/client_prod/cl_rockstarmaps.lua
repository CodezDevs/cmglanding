eventMapHasLoaded=false;local a={}local b={}local c={}local d={}local e=nil;local f={[-545580178]={pfxDict="scr_stunts",pfxName="scr_stunts_fire_ring",offset=vector3(0.0,0.0,4.0),scale=0.2},[-35121593]={pfxDict="scr_stunts",pfxName="scr_stunts_fire_ring",offset=vector3(0.0,0.0,10.0),scale=0.4},[737590223]={pfxDict="scr_stunts",pfxName="scr_stunts_fire_ring",offset=vector3(0.0,0.0,25.0),scale=1.0}}local g={["cmg_minigames_dust2"]=true,["cmg_minigame_lego"]=true,["nuketown"]=true,["shipment"]=true,["map1"]=true,["dragonball"]=true,["NOT_IPL"]=true}local function h(i,j,k,l,m,n,o,p)if f[j]then local q=f[j]CMG.loadPtfx(q.pfxDict)local r=StartParticleFxLoopedAtCoord(q.pfxName,k+q.offset.x,l+q.offset.y,m+q.offset.z,n,o,p,q.scale,false,false,false,false)SetParticleFxLoopedColour(r,0,255,0,false)table.insert(b,r)end end;local s={[-1006978322]=true,[-388593496]=true,[-66244843]=true,[-1170462683]=true,[993442923]=true,[737005456]=true,[-904856315]=true,[-279848256]=true,[588352126]=true}local t={[346059280]=true,[620582592]=true,[85342060]=true,[483832101]=true,[930976262]=true,[1677872320]=true,[708828172]=true,[950795200]=true,[-1260656854]=true,[-1875404158]=true,[-864804458]=true,[-1302470386]=true,[1518201148]=true,[384852939]=true,[117169896]=true,[-1479958115]=true,[-227275508]=true,[1431235846]=true,[1832852758]=true}local function u(j,v)if v==-1 then return false end;local w,x=-1,-1;if s[j]then if v==1 then w,x=15,0.3 elseif v==2 then w,x=25,0.3 elseif v==3 then w,x=35,0.5 elseif v==4 then w,x=45,0.5 elseif v==5 then w,x=100,0.5 else w,x=25,0.4 end elseif t[j]then x=-1;if v==1 then w=44 elseif v==2 then w=30 elseif v==3 then w=16 else w=30 end else return false end;return true,w,x end;local function y(i,j,z)if z then local A=z;local B,C,D=u(j,A)if B then if C>-1 then SetObjectStuntPropSpeedup(i,C)end;if D>-1 then SetObjectStuntPropDuration(i,D)end end end end;local function E()if not IsNamedRendertargetRegistered("blimp_text")then RegisterNamedRendertarget("blimp_text",false)end;if not IsNamedRendertargetLinked(`sr_mp_spec_races_blimp_sign`)then LinkNamedRendertarget(`sr_mp_spec_races_blimp_sign`)end;local F=RequestScaleformMovie("BLIMP_TEXT")while not HasScaleformMovieLoaded(F)do Citizen.Wait(0)end;BeginScaleformMovieMethod(F,"SET_MESSAGE")ScaleformMovieMethodAddParamTextureNameString_2("CMG EVENTS")BeginTextCommandScaleformString("SR_BLIMPTX")EndTextCommandScaleformString()EndScaleformMovieMethod()BeginScaleformMovieMethod(F,"SET_COLOUR")ScaleformMovieMethodAddParamInt(1)EndScaleformMovieMethod()BeginScaleformMovieMethod(F,"SET_SCROLL_SPEED")ScaleformMovieMethodAddParamFloat(100.0)EndScaleformMovieMethod()N_0x32f34ff7f617643b(F,1)e=F end;function loadMap(G,H,I)eventMapHasLoaded=false;if H then DoScreenFadeOut(250)end;CMG.setPlayerInvisible(true)if g[G]then if G~="NOT_IPL"then print("loading ipl")RequestIpl(G)while not IsIplActive(G)do print("loading ipl")Wait(0)end;table.insert(d,G)end else for J=1,#G.models do CMG.loadModel(G.models[J])local K=CreateObjectNoOffset(G.models[J],G.modelPos[J].x,G.modelPos[J].y,G.modelPos[J].z,false,false,false)if G.prpclr then SetObjectTextureVariation(K,G.prpclr[J])end;FreezeEntityPosition(K,true)SetEntityHeading(K,G.modelHeading[J])SetEntityRotation(K,G.modelRotation[J].x,G.modelRotation[J].y,G.modelRotation[J].z,2,true)h(K,G.models[J],G.modelPos[J].x,G.modelPos[J].y,G.modelPos[J].z,G.modelRotation[J].x,G.modelRotation[J].y,G.modelRotation[J].z)if G.speedBoosts then y(K,G.models[J],G.speedBoosts[J])end;table.insert(a,K)end;for J=1,#G.models2 do CMG.loadModel(G.models2[J])local K=CreateObjectNoOffset(G.models2[J],G.modelPos2[J].x,G.modelPos2[J].y,G.modelPos2[J].z,false,false,G.modelDynamic2[J])SetObjectTextureVariation(K,G.prpclr2[J])SetEntityHeading(K,G.modelHeading2[J])SetEntityRotation(K,G.modelRotation2[J].x,G.modelRotation2[J].y,G.modelRotation2[J].z,2,true)h(K,G.models2[J],G.modelPos2[J].x,G.modelPos2[J].y,G.modelPos2[J].z,G.modelRotation2[J].x,G.modelRotation2[J].y,G.modelRotation2[J].z)table.insert(a,K)end;if not I then for J=1,#G.vehicles.models do local j=G.vehicles.models[J]local L=G.vehicles.locations[J]local M=G.vehicles.heading[J]CMG.loadModel(j)local N=CMG.spawnVehicle(j,L.x,L.y,L.z,M,false,false,true)SetVehicleDoorsLocked(N,2)FreezeEntityPosition(N,true)table.insert(c,N)end end end;if G.pickups then for J=1,#G.pickups do local O=G.pickups[J]CMG.createPickup(O.type,O.coords)end end;E()CMG.setPlayerInvisible(false)eventMapHasLoaded=true;if H then Wait(1000)DoScreenFadeIn(1000)end end;function CMG.cleanupRockstarMaps()for P,i in pairs(a)do if DoesEntityExist(i)then DeleteObject(i)end end;for P,Q in pairs(b)do if DoesParticleFxLoopedExist(Q)then StopParticleFxLooped(Q,false)end end;for P,N in pairs(c)do if DoesEntityExist(N)then DeleteEntity(N)end end;for P,R in pairs(d)do RemoveIpl(R)end;if HasScaleformMovieLoaded(e)then SetScaleformMovieAsNoLongerNeeded(e)end;if IsNamedRendertargetRegistered("blimp_text")then ReleaseNamedRendertarget("blimp_text")end;a={}b={}c={}d={}e=nil end;RegisterNetEvent("CMG:loadRockstarMap",function(S)loadMap(S,true)end)Citizen.CreateThread(function()while true do if e then SetTextRenderId(GetNamedRendertargetRenderId("blimp_text"))SetScriptGfxDrawOrder(4)SetScriptGfxDrawBehindPausemenu(true)SetScaleformFitRendertarget(e,true)DrawScaleformMovie(e,0.0,-0.08,1.0,1.7,255,255,255,255,0)SetTextRenderId(GetDefaultScriptRendertargetRenderId())end;Citizen.Wait(0)end end)