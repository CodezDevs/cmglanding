local a;local b;local c={vector3(448.29037475586,-988.74841308594,30.689607620239),vector3(-1083.501953125,-828.93444824219,5.4578394889832)}RegisterNetEvent("CMG:policeSyncAllDoors",function(d,e)b=d;a=e end)AddEventHandler("CMG:onClientSpawn",function(f,g)if g then while a==nil or b==nil do Citizen.Wait(1000)end;enter_openPoliceDoor=function()end;exit_openPoliceDoor=function()end;ontick_openPoliceDoor=function(h)local i=""if globalOnPoliceDuty then i=" (E to toggle lock)"end;if a[h.doorHash]==5 or a[h.doorHash]==0 then CMG.DrawText3D(h.position,"ðŸ”“"..i,0.45,4)else CMG.DrawText3D(h.position,"ðŸ”’"..i,0.45,4)end;if IsControlJustPressed(0,38)and globalOnPoliceDuty then local j,k=CMG.getSelectedEntity()if not j or k~=1 then CMG.loadAnimDict("anim@heists@keycard@")Citizen.CreateThread(function()TaskPlayAnim(PlayerPedId(),"anim@heists@keycard@","exit",5.0,1.0,-1,48,0,0,0,0)Wait(1200)ClearPedTasks(PlayerPedId())RemoveAnimDict("anim@heists@keycard@")end)if a[h.doorHash]==4 then TriggerServerEvent("CMG:policeSetDoorState",h.doorHash,5)else TriggerServerEvent("CMG:policeSetDoorState",h.doorHash,4)end end end end;for l=1,#b,1 do CMG.createArea("openPoliceDoor_"..b[l].doorHash,b[l].position,1.5,5,enter_openPoliceDoor,exit_openPoliceDoor,ontick_openPoliceDoor,{doorHash=b[l].doorHash,position=b[l].position})end;for l=1,#b do AddDoorToSystem(b[l].doorHash,b[l].modelHash,b[l].position.x,b[l].position.y,b[l].position.z,false,false,false)DoorSystemSetDoorState(b[l].doorHash,a[b[l].doorHash],false,false)end;local m=function()a=CMG.TriggerServerCallback("CMG:enterPoliceSyncDoors")for n,o in pairs(a)do DoorSystemSetDoorState(n,o,false,false)if o==0 or o==5 then DoorSystemSetHoldOpen(n,true)else DoorSystemSetHoldOpen(n,false)end end end;for l=1,#c do CMG.createArea("policeSyncDoorsOnAreaEnter",c[l],250,250,m,function()end,function()end,{})end end end)RegisterNetEvent("CMG:policeSyncDoor",function(p,q)DoorSystemSetDoorState(p,q,false,false)if q==0 or q==5 then DoorSystemSetHoldOpen(p,true)else DoorSystemSetHoldOpen(p,false)end;if a and a[p]~=nil then a[p]=q end end)