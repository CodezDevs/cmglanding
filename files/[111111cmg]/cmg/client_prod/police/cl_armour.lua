local a={vector3(459.33172607422,-979.49810791016,30.689582824708),vector3(1841.6328125,3690.603515625,34.26708984375),vector3(-436.15905761719,5997.91015625,31.716093063354),vector3(-1106.9595947266,-824.35784912109,14.282789230347),vector3(-447.70739746094,6013.6123046875,31.716396331787),vector3(1777.8238525391,2542.4521484375,45.797782897949)}local b={vector3(454.01052856445,-1024.8431396484,28.496109008789)}AddEventHandler("CMG:onClientSpawn",function(c,d)if d then local e=function()drawNativeNotification("Press ~INPUT_PICKUP~ to Pickup Armour")end;local f=function()end;local g=function()if IsControlJustPressed(1,51)then if globalOnPoliceDuty or globalOnPrisonDuty then TriggerServerEvent("CMG:getArmour")local h=GetSoundId()PlaySoundFrontend(h,"Armour_On","DLC_GR_Steal_Miniguns_Sounds",true)ReleaseSoundId(h)else tvRP.notify("~r~You shouldn't be here...Engaging defenses in 3..2..1...")end end end;for i,j in pairs(a)do CMG.createArea("armour_"..i,j,1.5,6,e,f,g)tvRP.addMarker(j.x,j.y,j.z-0.2,0.5,0.5,0.5,0,50,255,170,50,20,false,false,true)end end end)local k=false;local l=false;function CMG.isPlayerInAnimalForm()return k or GetPedType(PlayerPedId())==28 end;function CMG.isPoliceHorse()return l end;local function m()local n=PlayerPedId()if IsPedFalling(n)or IsPedRagdoll(n)or GetEntityHealth(n)<=102 or IsPedInParachuteFreeFall(n)then notify("~r~You can not get a horse out at this time.")return end;local o=GetEntityModel(PlayerPedId())if o==`mp_m_freemode_01`or o==`mp_f_freemode_01`then k=true;l=true;local p=CMG.loadModel("a_c_deer")local q=CMG.getPlayerCoords()local r=ClonePed(PlayerPedId(),true,true,true)local s=GetEntityHealth(PlayerPedId())local t=tvRP.getCustomization()tvRP.setCustomization({modelhash=`a_c_deer`})SetModelAsNoLongerNeeded(p)Citizen.CreateThread(function()Citizen.Wait(200)SetEntityHealth(PlayerPedId(),s)end)local u="Horse"local v=1;local w=0.12;local x=-0.2;AttachEntityToEntity(r,PlayerPedId(),GetPedBoneIndex(PlayerPedId(),24816),x,0.0,w,0.0,0.0,-90.0,false,false,false,true,2,true)CMG.loadAnimDict("amb@prop_human_seat_chair@male@generic@base")TaskPlayAnim(r,"amb@prop_human_seat_chair@male@generic@base","base",8.0,1,-1,1,1.0,0,0,0)RemoveAnimDict("amb@prop_human_seat_chair@male@generic@base")FreezeEntityPosition(PlayerPedId(),false)FreezeEntityPosition(r,false)SetPedComponentVariation(PlayerPedId(),0,0,0,0)SetBlockingOfNonTemporaryEvents(r,true)SetPedCombatAttributes(r,292,true)SetPedFleeAttributes(r,0,0)SetPedRelationshipGroupHash(r,`CIVFEMALE`)while k do Wait(0)drawNativeNotification("~s~~INPUT_JUMP~ to exit horse")CMG.setWeapon(PlayerPedId(),"weapon_unarmed",true)DisableControlAction(0,263,true)DisableControlAction(0,264,true)DisableControlAction(0,257,true)DisableControlAction(0,140,true)DisableControlAction(0,141,true)DisableControlAction(0,142,true)DisableControlAction(0,143,true)DisableControlAction(0,24,true)DisableControlAction(0,25,true)SetPedDropsWeaponsWhenDead(r,false)if IsDisabledControlPressed(0,22)then k=false end end;DeleteEntity(r)DetachEntity(PlayerPedId())local y=GetEntityHealth(PlayerPedId())tvRP.setCustomization(t)Citizen.CreateThread(function()Citizen.Wait(200)SetEntityHealth(PlayerPedId(),y)Citizen.Wait(1000)l=false end)else tvRP.notify("~r~Custom peds cannot be used with horses.")end end;AddEventHandler("CMG:onClientSpawn",function(c,d)if d then local z=function()drawNativeNotification("Press ~INPUT_PICKUP~ to spawn police horse!")end;local A=function()end;local B=function()if IsControlJustPressed(1,51)and not k then if globalOnPoliceDuty and not inOrganHeist then m()else tvRP.notify("~r~This is only available to the MET Police only.")end end end;for C,D in pairs(b)do CMG.createArea("horse_"..C,D,1.5,6,z,A,B)tvRP.addMarker(D.x,D.y,D.z,1.0,1.0,1.0,0,50,255,170,50,42,false,false,true)end end end)RegisterCommand("policehorse",function()if not k and not inOrganHeist then if globalOnPoliceDuty then if globalHorseTrained then m()else tvRP.notify("~r~You do not have the [Horse Trained] whitelist.")end else tvRP.notify("~r~This is only available to the MET Police only.")end end end)