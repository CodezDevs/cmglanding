local a=`caddy2`local b=`s_m_m_bouncer_01`local c={active=false,vehicleHandle=0,driverHandle=0,cameraEnabled=false,cameraHandle=0,nightVisionEnabled=false,hoseEnabled=false,thermal=false}function CMG.isPlayerUsingRobot()return c.active end;local d=false;local function e(f)BeginTextCommandScaleformString("STRING")AddTextComponentSubstringKeyboardDisplay(f)EndTextCommandScaleformString()end;local function g(h)ScaleformMovieMethodAddParamPlayerNameString(h)end;local function i(j)local j=RequestScaleformMovie(j)while not HasScaleformMovieLoaded(j)do Citizen.Wait(0)end;BeginScaleformMovieMethod(j,"CLEAR_ALL")EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"SET_CLEAR_SPACE")ScaleformMovieMethodAddParamInt(200)EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(0)g(GetControlInstructionalButton(0,208,true))e("Controlled Explosion")EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(1)g(GetControlInstructionalButton(0,178,true))e("Night Vision")EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(2)g(GetControlInstructionalButton(0,121,true))e("Camera Stream")EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(3)g(GetControlInstructionalButton(0,175,true))e("Right")EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(4)g(GetControlInstructionalButton(0,174,true))e("Left")EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(5)g(GetControlInstructionalButton(0,173,true))e("Backwards")EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(6)g(GetControlInstructionalButton(0,172,true))e("Forward")EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(7)g(GetControlInstructionalButton(1,74,true))e("Hose")EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"DRAW_INSTRUCTIONAL_BUTTONS")EndScaleformMovieMethod()BeginScaleformMovieMethod(j,"SET_BACKGROUND_COLOUR")ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(80)EndScaleformMovieMethod()return j end;local function k()if c.cameraEnabled then local l=500*math.ceil(GetDistanceBetweenCoords(CMG.getPlayerCoords(),GetEntityCoords(c.vehicleHandle),true)/10)RenderScriptCams(false,true,l,true,false)ClearTimecycleModifier()if DoesCamExist(c.cameraHandle)then DestroyCam(c.cameraHandle)end;c.cameraEnabled=false;if c.nightVisionEnabled then SetNightvision(false)c.nightVisionEnabled=false end else c.cameraHandle=CreateCam("DEFAULT_SCRIPTED_CAMERA",true)AttachCamToEntity(c.cameraHandle,c.vehicleHandle,-0.3,0.0,1.2,true)local l=500*math.ceil(GetDistanceBetweenCoords(CMG.getPlayerCoords(),GetEntityCoords(c.vehicleHandle),true)/10)c.cameraEnabled=true;RenderScriptCams(true,true,l,true,true)Wait(l)SetTimecycleModifier("scanline_cam_cheap")SetTimecycleModifierStrength(1.0)Citizen.CreateThread(function()while DoesCamExist(c.cameraHandle)do Citizen.Wait(2)local m=GetEntityRotation(c.vehicleHandle)SetCamRot(c.cameraHandle,m.x,m.y,m.z,2)end end)end end;local n={}TriggerEvent("chat:addSuggestion","/eod","Setup or remove an EOD robot.")local function o()if c.hoseEnabled then TriggerServerEvent("CMG:eodDeactivateHose",VehToNet(c.vehicleHandle))end;Wait(500)c.active=false;DeletePed(c.driverHandle)SetEntityAsMissionEntity(c.vehicleHandle,false,false)DeleteEntity(c.vehicleHandle)SetModelAsNoLongerNeeded(a)if c.thermal then SetSeethrough(false)end end;local function p()CMG.loadModel(a)CMG.loadModel(b)local q=CMG.getPlayerPed()local r=GetOffsetFromEntityInWorldCoords(q,0.0,4.0,0.0)local s=GetEntityHeading(q)c.vehicleHandle=CMG.spawnVehicle(a,r,s,true)Wait(1000)SetEntityAsMissionEntity(c.vehicleHandle,true,true)local t=NetworkGetNetworkIdFromEntity(c.vehicleHandle)NetworkUseHighPrecisionBlending(t,true)SetNetworkIdCanMigrate(t,true)SetNetworkIdExistsOnAllMachines(t,true)c.driverHandle=CreatePed(4,b,r.x,r.y,r.z,s,true,true)SetEntityInvincible(c.driverHandle,true)SetEntityVisible(c.driverHandle,false,false)FreezeEntityPosition(c.driverHandle,true)SetPedAlertness(c.driverHandle,0.0)TaskWarpPedIntoVehicle(c.driverHandle,c.vehicleHandle,-1)while not IsPedInVehicle(c.driverHandle,c.vehicleHandle,false)do Wait(0)end;SetVehicleDoorsLocked(c.vehicleHandle,2)SetVehicleDoorsLockedForAllPlayers(c.vehicleHandle,true)SetModelAsNoLongerNeeded(a)SetModelAsNoLongerNeeded(b)c.active=true end;RegisterNetEvent("CMG:eodToggle",function()if not c.active then p()form=i("instructional_buttons")else o()end end)local function u()Citizen.CreateThread(function()PlaySoundFrontend(-1,"5s_To_Event_Start_Countdown","GTAO_FM_Events_Soundset",true)drawNativeNotification("Press ~INPUT_FRONTEND_LT~ to cancel.")Wait(8000)if not d then SetEntityInvincible(c.vehicleHandle,true)local r=GetOffsetFromEntityInWorldCoords(c.vehicleHandle,0.0,2.0,0.1)TriggerServerEvent("CMG:syncEodExplosion",r)SetVehicleFixed(c.vehicleHandle)PlaySoundFrontend(-1,"Bomb_Disarmed","GTAO_Speed_Convoy_Soundset",true)Wait(1000)PlaySoundFrontend(-1,"BASE_JUMP_PASSED","HUD_AWARDS",true)end;d=false end)end;Citizen.CreateThread(function()while true do if c.active then local r=CMG.getPlayerCoords()local v=GetEntityCoords(c.vehicleHandle,true)local w=#(r-v)if w<=1000.0 then if not NetworkHasControlOfEntity(c.driverHandle)then NetworkRequestControlOfEntity(c.driverHandle)elseif not NetworkHasControlOfEntity(c.vehicleHandle)then NetworkRequestControlOfEntity(c.vehicleHandle)end else TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,6,2500)end;DisableControlAction(0,172,true)DisableControlAction(1,172,true)DisableControlAction(0,300,true)DisableControlAction(0,27,true)DisableControlAction(1,27,true)DisableControlAction(0,188,true)DisableControlAction(1,188,true)if IsDisabledControlPressed(0,172)and not IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,9,1)end;if IsDisabledControlJustReleased(0,172)or IsControlJustReleased(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,6,2500)end;if IsControlPressed(0,173)and not IsDisabledControlPressed(0,172)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,22,1)end;if IsControlPressed(0,174)and IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,13,1)end;if IsControlPressed(0,175)and IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,14,1)end;if IsDisabledControlPressed(0,172)and IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,30,100)end;if IsControlPressed(0,174)and IsDisabledControlPressed(0,172)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,7,1)end;if IsControlPressed(0,175)and IsDisabledControlPressed(0,172)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,8,1)end;if IsControlPressed(0,174)and not IsDisabledControlPressed(0,172)and not IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,4,1)end;if IsControlPressed(0,175)and not IsDisabledControlPressed(0,172)and not IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,5,1)end;if IsControlJustPressed(0,121)then k()end;if IsControlJustPressed(0,178)then if c.cameraEnabled then if c.thermal then SetSeethrough(false)c.thermal=false else SetSeethrough(true)c.thermal=true end end end;if IsControlJustPressed(0,212)then if c.cameraEnabled then if c.nightVisionEnabled then SetNightvision(false)c.nightVisionEnabled=false else SetNightvision(true)c.nightVisionEnabled=true end end end;if IsControlJustPressed(0,208)then u()end;if IsControlJustPressed(0,207)then d=true;drawNativeNotification("Explosion cancelled")end;if not c.hoseEnabled then if IsControlPressed(1,74)then c.hoseEnabled=true;PlaySoundFrontend(-1,"EDIT","HUD_DEATHMATCH_SOUNDSET",true)TriggerServerEvent("CMG:eodActivateHose",NetworkGetNetworkIdFromEntity(c.vehicleHandle))while not IsControlJustReleased(1,74)or not c.hoseEnabled do DisableControlAction(0,172,true)DisableControlAction(1,172,true)DisableControlAction(0,300,true)DisableControlAction(0,27,true)DisableControlAction(1,27,true)DisableControlAction(0,188,true)DisableControlAction(1,188,true)if IsDisabledControlPressed(0,172)and not IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,9,1)end;if IsDisabledControlJustReleased(0,172)or IsControlJustReleased(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,6,2500)end;if IsControlPressed(0,173)and not IsDisabledControlPressed(0,172)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,22,1)end;if IsControlPressed(0,174)and IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,13,1)end;if IsControlPressed(0,175)and IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,14,1)end;if IsDisabledControlPressed(0,172)and IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,30,100)end;if IsControlPressed(0,174)and IsDisabledControlPressed(0,172)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,7,1)end;if IsControlPressed(0,175)and IsDisabledControlPressed(0,172)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,8,1)end;if IsControlPressed(0,174)and not IsDisabledControlPressed(0,172)and not IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,4,1)end;if IsControlPressed(0,175)and not IsDisabledControlPressed(0,172)and not IsControlPressed(0,173)then TaskVehicleTempAction(c.driverHandle,c.vehicleHandle,5,1)end;if IsControlJustPressed(0,178)then if c.cameraEnabled then if c.thermal then SetSeethrough(false)c.thermal=false else SetSeethrough(true)c.thermal=true end end end;if IsControlJustPressed(0,212)then if c.cameraEnabled then if c.nightVisionEnabled then SetNightvision(false)c.nightVisionEnabled=false else SetNightvision(true)c.nightVisionEnabled=true end end end;if IsControlJustPressed(0,208)then u()end;if IsControlJustPressed(0,207)then d=true end;Wait(0)end;if c.hoseEnabled then TriggerServerEvent("CMG:eodDeactivateHose",NetworkGetNetworkIdFromEntity(c.vehicleHandle))c.hoseEnabled=false end end end end;Wait(0)end end)Citizen.CreateThread(function()form=i("instructional_buttons")while true do if c.active then DrawScaleformMovieFullscreen(form,255,255,255,255,0)end;Wait(0)end end)RegisterNetEvent("CMG:syncEodExplosionClient",function(r)local w=#(r-CMG.getPlayerCoords())if w<150.0 then AddOwnedExplosion(CMG.getPlayerPed(),r.x,r.y,r.z,4,17.0,true,false,6.0)end end)RegisterNetEvent("CMG:eodActivateHose",function(x)CMG.loadPtfx("core")local y=CMG.getObjectId(x)n[y]={y,y}UseParticleFxAsset("core")SetParticleFxShootoutBoat(1)local z=StartParticleFxLoopedOnEntity("water_cannon_jet",y,0.0,0.19,1.1,0.0,0.0,-0.7,0.7,false,false,false)while true do local A=false;if n[y]==nil then break end;Wait(100)end;StopParticleFxLooped(z,false)RemoveNamedPtfxAsset("core")end)RegisterNetEvent("CMG:eodDeactivateHose",function(x)local y=CMG.getObjectId(x)n[y]=nil end)RegisterNetEvent("CMG:frontendEodSound",function(r,B,C)local w=#(r-CMG.getPlayerCoords())if w<30.0 then PlaySoundFrontend(-1,B,C,true)end end)RegisterCommand("sm",function(D,E,F)local G=CMG.getUserId()if CMG.isDeveloper(G)then if E[1]~=nil then local q=CMG.getPlayerPed()local H=tonumber(E[1])local s=GetEntityHeading(q)if IsModelValid(H)then CMG.loadModel(H)local I=GetOffsetFromEntityInWorldCoords(q,0.0,1.0,0.0)local J=CreateObject(H,I,true,true,true)while not DoesEntityExist(J)do Wait(0)end;SetEntityHeading(J,s)PlaceObjectOnGroundProperly(J)FreezeEntityPosition(J,true)SetModelAsNoLongerNeeded(H)else tvRP.notify("~r~Error~w~: Invalid Model")end end end end,false)Citizen.CreateThread(function()while true do local G=CMG.getUserId()if not CMG.isDeveloper(G)then local x=CMG.getPlayerVehicle()if x~=0 then local H=GetEntityModel(x)if H==a then DeleteEntity(x)end end end;Wait(2000)end end)RegisterCommand("eodvisorup",function()local G=CMG.getUserId()if CMG.isDeveloper(G)then SetPedPropIndex(PlayerPedId(),0,191,0,true)end end,false)RegisterCommand("eodvisordown",function()local G=CMG.getUserId()if CMG.isDeveloper(G)then SetPedPropIndex(PlayerPedId(),0,190,0,true)end end,false)