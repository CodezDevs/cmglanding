local a={Camera=true,LoseConnectionDistance=100.0}local b={}Attached=false;AddEventHandler('longboard:clear',function()DeleteEntity(b.Skate)DeleteVehicle(b.Entity)DeleteEntity(b.Driver)b.UnloadModels()Attached=false end)AddEventHandler('longboard:spawn',function()b.Start()end)b.Start=function()if DoesEntityExist(b.Entity)then return end;b.Spawn()while DoesEntityExist(b.Entity)and DoesEntityExist(b.Driver)do Citizen.Wait(5)local c=#(GetEntityCoords(CMG.getPlayerPed())-GetEntityCoords(b.Entity))b.DrawInstructions(c)b.HandleKeys(c)if c<=a.LoseConnectionDistance then if not NetworkHasControlOfEntity(b.Driver)then NetworkRequestControlOfEntity(b.Driver)elseif not NetworkHasControlOfEntity(b.Entity)then NetworkRequestControlOfEntity(b.Entity)end else TaskVehicleTempAction(b.Driver,b.Entity,6,2500)end end end;b.HandleKeys=function(c)if c<=1.5 then if IsControlJustPressed(0,38)then b.Attach("pick")end;if IsControlJustReleased(0,47)then if Attached then b.AttachPlayer(false)else b.AttachPlayer(true)end end end;if c<a.LoseConnectionDistance then if IsControlPressed(0,172)and not IsControlPressed(0,173)then TaskVehicleTempAction(b.Driver,b.Entity,9,1)end;if IsControlJustReleased(0,172)or IsControlJustReleased(0,173)then TaskVehicleTempAction(b.Driver,b.Entity,6,2500)end;if IsControlPressed(0,173)and not IsControlPressed(0,172)then TaskVehicleTempAction(b.Driver,b.Entity,22,1)end;if IsControlPressed(0,174)and IsControlPressed(0,173)then TaskVehicleTempAction(b.Driver,b.Entity,13,1)end;if IsControlPressed(0,175)and IsControlPressed(0,173)then TaskVehicleTempAction(b.Driver,b.Entity,14,1)end;if IsControlPressed(0,172)and IsControlPressed(0,173)then TaskVehicleTempAction(b.Driver,b.Entity,30,100)end;if IsControlPressed(0,174)and IsControlPressed(0,172)then TaskVehicleTempAction(b.Driver,b.Entity,7,1)end;if IsControlPressed(0,175)and IsControlPressed(0,172)then TaskVehicleTempAction(b.Driver,b.Entity,8,1)end;if IsControlPressed(0,174)and not IsControlPressed(0,172)and not IsControlPressed(0,173)then TaskVehicleTempAction(b.Driver,b.Entity,4,1)end;if IsControlPressed(0,175)and not IsControlPressed(0,172)and not IsControlPressed(0,173)then TaskVehicleTempAction(b.Driver,b.Entity,5,1)end end end;b.DrawInstructions=function(c)local d={{["label"]="Right",["button"]="~INPUT_CELLPHONE_RIGHT~"},{["label"]="Foward",["button"]="~INPUT_CELLPHONE_UP~"},{["label"]="Back",["button"]="~INPUT_CELLPHONE_DOWN~"},{["label"]="Left",["button"]="~INPUT_CELLPHONE_LEFT~"}}local e={["label"]="Pick Up",["button"]="~INPUT_CONTEXT~"}local f={{["label"]="Get in/Get off",["button"]="~INPUT_DETONATE~"}}if c<=a.LoseConnectionDistance then for g=1,#d do local h=d[g]table.insert(f,h)end;if c<=1.5 then table.insert(f,e)if not Attached then CMG.DrawText3D(GetEntityCoords(b.Entity),"[E] Pick Up, [G] Get on",0.35,4)end end end;Citizen.CreateThread(function()Citizen.Wait(0)local i=RequestScaleformMovie("instructional_buttons")while not HasScaleformMovieLoaded(i)do Wait(0)end;BeginScaleformMovieMethod(i,"CLEAR_ALL")BeginScaleformMovieMethod(i,"TOGGLE_MOUSE_BUTTONS")ScaleformMovieMethodAddParamBool(0)EndScaleformMovieMethod()for g,j in ipairs(f)do BeginScaleformMovieMethod(i,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(g-1)ScaleformMovieMethodAddParamPlayerNameString(j["button"])ScaleformMovieMethodAddParamTextureNameString(j["label"])EndScaleformMovieMethod()end;BeginScaleformMovieMethod(i,"DRAW_INSTRUCTIONAL_BUTTONS")ScaleformMovieMethodAddParamInt(-1)EndScaleformMovieMethod()DrawScaleformMovieFullscreen(i,255,255,255,255)if Attached then local k=GetEntityRotation(b.Entity).x;local l=GetEntityRotation(b.Entity).y;if-40.0<k and k>40.0 or-40.0<l and l>40.0 then b.AttachPlayer(false)SetPedToRagdoll(CMG.getPlayerPed(),4000,4000,0,true,true,false)end end end)end;b.Spawn=function()b.LoadModels({`rcbandito`,68070371,`p_defilied_ragdoll_01_s`,"pickup_object","move_strafe@stealth"})local m,n=GetEntityCoords(CMG.getPlayerPed())+GetEntityForwardVector(CMG.getPlayerPed())*2.0,GetEntityHeading(CMG.getPlayerPed())b.Entity=CreateVehicle(`rcbandito`,m,n,true)DecorSetInt(b.Entity,"CMGACVeh",955)b.Skate=CreateObject(`p_defilied_ragdoll_01_s`,0.0,0.0,0.0,true,true,true)while not DoesEntityExist(b.Entity)do Citizen.Wait(5)end;DecorSetInt(b.Entity,"CMGACVeh",955)while not DoesEntityExist(b.Skate)do Citizen.Wait(5)end;SetVehicleHandlingFloat(b.Entity,"CHandlingData","fSuspensionForce",1.5)SetVehicleCheatPowerIncrease(b.Entity,0.1)SetEntityNoCollisionEntity(b.Entity,CMG.getPlayerPed(),false)SetEntityVisible(b.Entity,false)SetVehicleUseCutsceneWheelCompression(b.Entity,true,true,true)AttachEntityToEntity(b.Skate,b.Entity,GetPedBoneIndex(CMG.getPlayerPed(),28422),0.0,0.0,-0.15,0.0,0.0,90.0,true,true,true,true,1,true)SetEntityCollision(b.Skate,true,true)b.Driver=CreatePed(5,68070371,m,n,true)SetEntityInvincible(b.Driver,true)SetEntityVisible(b.Driver,false)FreezeEntityPosition(b.Driver,true)SetPedAlertness(b.Driver,0.0)TaskWarpPedIntoVehicle(b.Driver,b.Entity,-1)while not IsPedInVehicle(b.Driver,b.Entity)do Citizen.Wait(0)end;b.Attach("place")end;b.Attach=function(o)if not DoesEntityExist(b.Entity)then return end;if o=="place"then AttachEntityToEntity(b.Entity,CMG.getPlayerPed(),GetPedBoneIndex(CMG.getPlayerPed(),28422),-0.1,0.0,-0.2,70.0,0.0,270.0,1,1,0,0,2,1)TaskPlayAnim(CMG.getPlayerPed(),"pickup_object","pickup_low",8.0,-8.0,-1,0,0,false,false,false)Citizen.Wait(800)DetachEntity(b.Entity,false,true)PlaceObjectOnGroundProperly(b.Entity)elseif o=="pick"then Citizen.Wait(100)TaskPlayAnim(CMG.getPlayerPed(),"pickup_object","pickup_low",8.0,-8.0,-1,0,0,false,false,false)Citizen.Wait(600)AttachEntityToEntity(b.Entity,CMG.getPlayerPed(),GetPedBoneIndex(CMG.getPlayerPed(),28422),-0.1,0.0,-0.2,70.0,0.0,270.0,1,1,0,0,2,1)Citizen.Wait(900)DetachEntity(b.Entity)DeleteEntity(b.Skate)DeleteVehicle(b.Entity)DeleteEntity(b.Driver)b.UnloadModels()end end;b.LoadModels=function(p)for q=1,#p do local r=p[q]if not b.CachedModels then b.CachedModels={}end;table.insert(b.CachedModels,r)if IsModelValid(r)then local s=CMG.loadModel(r)else while not HasAnimDictLoaded(r)do RequestAnimDict(r)Citizen.Wait(0)end end end end;b.UnloadModels=function()for q=1,#b.CachedModels do local r=b.CachedModels[q]if IsModelValid(r)then SetModelAsNoLongerNeeded(r)else RemoveAnimDict(r)end end end;b.AttachPlayer=function(t)if t then TaskPlayAnim(CMG.getPlayerPed(),"move_strafe@stealth","idle",8.0,8.0,-1,1,1.0,false,false,false)AttachEntityToEntity(CMG.getPlayerPed(),b.Entity,20,0.0,0.0,0.98,0.0,0.0,-15.0,true,true,true,true,true,true)SetEntityCollision(CMG.getPlayerPed(),true,false)Attached=true elseif not t then DetachEntity(CMG.getPlayerPed(),false,false)Attached=false;StopAnimTask(CMG.getPlayerPed(),"move_strafe@stealth","idle",1.0)end end;local u={vector3(-930.60235595703,-807.04138183594,15.897052764893)}local v=false;Citizen.CreateThread(function()while true do for w,x in pairs(u)do DrawMarker(38,u[w].x,u[w].y,u[w].z,0,0,0,0,0,0,1.001,1.0001,0.5001,0,125,255,100,0,0,4,0)local y=GetEntityCoords(CMG.getPlayerPed())local z=#(y-u[w])if z<=1.2 then drawNativeNotification("Press ~INPUT_PICKUP~ spawn a skateboard")if not v then v=true;PlaySound(-1,"SELECT","HUD_MINI_GAME_SOUNDSET",0,0,1)end;if IsControlJustPressed(1,38)then b.Start()end end end;Wait(0)end end)