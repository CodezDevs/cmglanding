local a=module("cfg/cfg_licenseplate")local b=a.licenseChangerCoords;local c=""local d={}RMenu.Add("main","dvla",RageUI.CreateMenu("","",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_licenseplateui","cmg_licenseplateui"))RMenu:Get("main","dvla"):SetSubtitle("~b~DVLA")RMenu.Add("owned","dvla",RageUI.CreateSubMenu(RMenu:Get("main","dvla"),"","",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_licenseplateui","cmg_licenseplateui"))RMenu:Get("owned","dvla"):SetSubtitle("~b~Owned license plates")RMenu.Add("owned_inuse","dvla",RageUI.CreateSubMenu(RMenu:Get("owned","dvla"),"","",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_licenseplateui","cmg_licenseplateui"))RMenu:Get("owned_inuse","dvla"):SetSubtitle("~b~Owned license plates")RMenu.Add("owned_notinuse","dvla",RageUI.CreateSubMenu(RMenu:Get("owned","dvla"),"","",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_licenseplateui","cmg_licenseplateui"))RMenu:Get("owned_notinuse","dvla"):SetSubtitle("~b~Owned license plates")RMenu.Add("individual_plate","dvla",RageUI.CreateSubMenu(RMenu:Get("owned","dvla"),"","",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_licenseplateui","cmg_licenseplateui"))RMenu:Get("individual_plate","dvla"):SetSubtitle("~b~Plate management")RMenu.Add("vehicle_list","dvla",RageUI.CreateSubMenu(RMenu:Get("owned","dvla"),"","",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_licenseplateui","cmg_licenseplateui"))RMenu:Get("vehicle_list","dvla"):SetSubtitle("~b~Choose which vehicle to apply this plate to!")RMenu.Add("confirm","dvla",RageUI.CreateMenu("","",CMG.getRageUIMenuWidth(),CMG.getRageUIMenuHeight(),"cmg_licenseplateui","cmg_licenseplateui"))RMenu:Get("confirm","dvla"):SetSubtitle("~b~Are you sure?")RegisterNetEvent("CMG:sendOwnedLicensePlates",function(e)for f,g in pairs(e)do d[g.license_plate]=g.vehicle end end)AddEventHandler("CMG:onClientSpawn",function(h,i)if i then local j=function(k)end;local l=function(k)RageUI.Visible(RMenu:Get("main","dvla"),false)end;local m=function(k)if IsControlJustPressed(1,38)then RageUI.CloseAll()RageUI.Visible(RMenu:Get("main","dvla"),not RageUI.Visible(RMenu:Get("main","dvla")))end;CMG.DrawText3D(b,"Press [E] to open License Plate Management",0.2)end;CMG.createArea("licenseplate",b,1.5,6,j,l,m,{})tvRP.addMarker(b.x,b.y,b.z-1,1.0,1.0,1.0,255,0,0,170,50,27)tvRP.addBlip(b.x,b.y,b.z,606,2,"Licence Plate Manager")end end)local function n(o)for p,q in pairs(d)do if o==q then return p end end end;RageUI.CreateWhile(1.0,RMenu:Get('main','dvla'),nil,function()RageUI.IsVisible(RMenu:Get("main","dvla"),true,true,true,function()RageUI.ButtonWithStyle("Owned License Plates","",{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then end end,RMenu:Get("owned","dvla"))RageUI.ButtonWithStyle("Check Plate Availability","",{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then local u=GetLicensePlateString("Enter License Plate")if u~=""then TriggerServerEvent("CMG:checkPlateAvailability",u)end end end)RageUI.ButtonWithStyle("Redeem License Plate","",{RightLabel="→→→"},true,function(r,s,t)if t then local p=GetLicensePlateString("Enter License Plate")if p~=""then TriggerServerEvent("CMG:startGetLicensePlate",string.upper(p))end end end,nil)RageUI.ButtonWithStyle("Check Phone Number Availability","",{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then local u=GetLicensePlateString("Enter Phone Number")if u~=""then TriggerServerEvent("CMG:checkPhoneNumberAvailability",u)end end end)RageUI.ButtonWithStyle("Redeem Phone Number","",{RightLabel="→→→"},true,function(r,s,t)if t then local v=GetLicensePlateString("Enter Phone Number")if v~=""then TriggerServerEvent("CMG:setPhoneNumber",string.upper(v))end end end,nil)end,function()end)RageUI.IsVisible(RMenu:Get("owned","dvla"),true,true,true,function()RageUI.ButtonWithStyle("Equipped plates","",{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then end end,RMenu:Get("owned_inuse","dvla"))RageUI.ButtonWithStyle("Available plates","",{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then end end,RMenu:Get("owned_notinuse","dvla"))end,function()end)RageUI.IsVisible(RMenu:Get("confirm","dvla"),true,true,true,function()RageUI.ButtonWithStyle("Yes","",{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then end end,RMenu:Get("main","dvla"))RageUI.ButtonWithStyle("No","",{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then tvRP.notify("~r~Cancelled.")end end,RMenu:Get("main","dvla"))end,function()end)RageUI.IsVisible(RMenu:Get("owned_inuse","dvla"),true,true,true,function()for p,q in pairs(d)do local w="In use on "..CMG.getVehicleNameFromId(q)if q~=""then RageUI.ButtonWithStyle(p,w,{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then c=p end end,nil)end end end,function()end)RageUI.IsVisible(RMenu:Get("owned_notinuse","dvla"),true,true,true,function()for p,q in pairs(d)do if q==""then RageUI.ButtonWithStyle(p,"",{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then c=p end end,RMenu:Get("individual_plate","dvla"))end end end,function()end)RageUI.IsVisible(RMenu:Get("individual_plate","dvla"),true,true,true,function()RageUI.ButtonWithStyle("Apply on Vehicle","",{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then end end,RMenu:Get("vehicle_list","dvla"))if d[c]==""then RageUI.ButtonWithStyle("Sell to Player","",{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then TriggerServerEvent("CMG:beginSellLicenseToPlayer",c)end end)else RageUI.Separator("~r~Cannot sell this plate, it is in use.")end end,function()end)RageUI.IsVisible(RMenu:Get("vehicle_list","dvla"),true,true,true,function()for o,x in pairs(globalOwnedPlayerVehicles)do local p=n(o)or"N/A"RageUI.ButtonWithStyle(x[1],"Current plate: "..p,{RightLabel="→→→"},true,function(r,s,t)if r then end;if s then end;if t then if d[c]==""then TriggerServerEvent("CMG:applyLicensePlate",o,c)else tvRP.notify("~r~Cannot apply this plate onto a vehicle, it is already in use!")end end end,RMenu:Get("individual_plate","dvla"))end end,function()end)end)RegisterNetEvent("CMG:updateOwnedLicensePlates",function(y,z,o)d[y]=o;d[z]=""end)RegisterNetEvent("CMG:addNewOwnedLicensePlate",function(y)d[y]=""end)RegisterNetEvent("CMG:removeOwnedLicensePlate",function(y)d[y]=nil end)function GetLicensePlateString(A)AddTextEntry('FMMC_MPM_NA',A)DisplayOnscreenKeyboard(1,"FMMC_MPM_NA","","","","","",30)while UpdateOnscreenKeyboard()==0 do DisableAllControlActions(0)Wait(0)end;if GetOnscreenKeyboardResult()then local B=GetOnscreenKeyboardResult()return B end;return""end