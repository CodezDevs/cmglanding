local a="anim@mp_fireworks"local b="scr_indep_fireworks"local c=`ind_prop_firework_03`local d=false;TriggerEvent('chat:addSuggestion','/firework','Lights a firework box')RegisterNetEvent("CMG:useFireworkBox",function()if CMG.getPlayerVehicle()==0 and GetEntityHealth(CMG.getPlayerPed())>102 and not d then d=true;CMG.loadAnimDict("anim@mp_fireworks")CMG.loadModel(c)local e=GetOffsetFromEntityInWorldCoords(CMG.getPlayerPed(),0.0,0.5,0.0)local f=GetOffsetFromEntityInWorldCoords(CMG.getPlayerPed(),0.0,0.5,-2.5)TaskPlayAnim(CMG.getPlayerPed(),a,"place_firework_3_box",-1,-8.0,3000,0,0,false,false,false)RemoveAnimDict("anim@mp_fireworks")Wait(1000)local g=CreateObject(c,e.x,e.y,e.z,true,false,false)PlaceObjectOnGroundProperly(g)FreezeEntityPosition(g,true)SetModelAsNoLongerNeeded(c)Wait(3000)TriggerServerEvent("CMG:fireworkParticleServer",f)Wait(10000)DeleteEntity(g)d=false else tvRP.notify("You are ~r~not able ~w~to use a ~r~firework box ~w~right now.")end end)RegisterNetEvent("CMG:fireworkParticle",function(e)firework(e)end)local h={{255,0,0},{0,255,0},{0,0,255},{255,255,0},{0,255,255},{255,0,255},{255,255,255}}function firework(e)CMG.loadPtfx("scr_indep_fireworks")UseParticleFxAsset("scr_indep_fireworks")UseParticleFxAsset("scr_indep_fireworks")for i=1,180 do UseParticleFxAsset("scr_indep_fireworks")local j=StartNetworkedParticleFxNonLoopedAtCoord("scr_indep_firework_trailburst",e,0.0,0.0,0.0,1.0,false,false,false,false)Wait(200)end;RemoveNamedPtfxAsset("scr_indep_fireworks")end;local k=nil;RegisterNetEvent("CMG:showFireworkDisplayRoute",function(l)if l then k=AddBlipForCoord(-407.36,1189.33,325.62)SetBlipColour(k,27)SetBlipScale(k,1.0)SetBlipRoute(k,true)else if k then RemoveBlip(k)k=nil end end end)local m=nil;local n=false;local o=0;local function p(q,r)Citizen.CreateThreadNow(function()local s=o;while m[s]do UseParticleFxAsset("scr_indep_fireworks")local t=StartParticleFxLoopedAtCoord("scr_indep_firework_fountain",q.x,q.y,q.z,0.0,0.0,0.0,r,false,false,false,false)Citizen.Wait(5000)StopParticleFxLooped(t,false)end end)end;local function u(q,r)Citizen.CreateThreadNow(function()local s=o;while m[s]do UseParticleFxAsset("scr_indep_fireworks")local t=StartParticleFxLoopedAtCoord("scr_indep_firework_starburst",q.x,q.y,q.z,0.0,0.0,0.0,r*math.random()*2.0,false,false,false,false)Citizen.Wait(math.random(500,2500))StopParticleFxLooped(t,false)end end)end;local function v(q,r)Citizen.CreateThreadNow(function()local s=o;while m[s]do UseParticleFxAsset("scr_indep_fireworks")local t=StartParticleFxLoopedAtCoord("scr_indep_firework_trailburst",q.x,q.y,q.z,0.0,0.0,0.0,r*math.random()*2.0,false,false,false,false)Citizen.Wait(math.random(500,2500))StopParticleFxLooped(t,false)end end)end;local function w(q,x)local y=(math.random()-0.5)*x*2;local z=(math.random()-0.5)*x*2;local A=math.random()*75.0;local B=#(q-vector3(q.x+y,q.y+z,q.z+25.0+A))ShootSingleBulletBetweenCoords(q.x,q.y,q.z,q.x+y,q.y+z,q.z+A+25.0,10,true,`weapon_firework`,PlayerPedId(),true,false,B*2.0)end;local function C(q,x,D)Citizen.CreateThreadNow(function()local s=o;while m[s]do w(q,x)Citizen.Wait(D)end end)end;local E={vector3(-421.4,1108.81,332.53),vector3(-436.92,1112.98,332.54),vector3(-401.12,1100.29,332.53),vector3(-458.45,1115.95,332.55),vector3(-413.05,1097.44,332.53),vector3(-449.77,1107.41,332.53),vector3(-431.66,1101.79,340.52),vector3(-401.41,1092.78,343.85),vector3(-439.14,1075.14,352.42),vector3(-462.21,1109.73,343.85)}local function F()while n do local G=CMG.getPlayerCoords()for H,I in ipairs(E)do if#(G-I)<10.0 then SetEntityCoords(CMG.getPlayerPed(),-410.52,1181.81,325.59,false,false,false)break end end;Citizen.Wait(0)end end;RegisterNetEvent("CMG:setFireworkDisplayStage",function(s)CMG.loadPtfx("scr_indep_fireworks")CMG.loadWeaponAsset("weapon_firework")if not m then m={}end;if not m[s]then m[s]={}end;o=s;if not n then n=true;Citizen.CreateThreadNow(F)end;if s==1 then p(vector3(-421.4,1108.81,332.53),2.0)p(vector3(-436.92,1112.98,332.54),2.0)p(vector3(-401.12,1100.29,332.53),2.0)p(vector3(-458.45,1115.95,332.55),2.0)elseif s==2 then m[1]=nil;C(vector3(-413.05,1097.44,332.53),25.0,1000)C(vector3(-449.77,1107.41,332.53),25.0,1000)elseif s==3 then u(vector3(-431.66,1101.79,340.52),2.0)u(vector3(-401.41,1092.78,343.85),2.0)u(vector3(-439.14,1075.14,352.42),2.0)u(vector3(-462.21,1109.73,343.85),2.0)elseif s==4 then m[2]=nil;m[3]=nil elseif s==5 then v(vector3(-431.66,1101.79,340.52),2.0)v(vector3(-401.41,1092.78,343.85),2.0)v(vector3(-439.14,1075.14,352.42),2.0)v(vector3(-462.21,1109.73,343.85),2.0)elseif s==6 then m[5]=nil elseif s==7 then p(vector3(-413.05,1097.44,332.53),1.0)p(vector3(-449.77,1107.41,332.53),1.0)elseif s==8 then m[7]=nil;C(vector3(-401.41,1092.78,343.85),100.0,400)C(vector3(-439.14,1075.14,352.42),100.0,400)C(vector3(-462.21,1109.73,343.85),100.0,400)elseif s==9 then m[8]=nil elseif s==10 then u(vector3(-431.66,1101.79,340.52),4.0)u(vector3(-401.41,1092.78,343.85),4.0)u(vector3(-439.14,1075.14,352.42),4.0)u(vector3(-462.21,1109.73,343.85),4.0)elseif s==11 then m[10]=nil;p(vector3(-421.4,1108.81,332.53),2.0)p(vector3(-436.92,1112.98,332.54),2.0)p(vector3(-401.12,1100.29,332.53),2.0)p(vector3(-458.45,1115.95,332.55),2.0)v(vector3(-431.66,1101.79,340.52),4.0)v(vector3(-401.41,1092.78,343.85),4.0)v(vector3(-439.14,1075.14,352.42),4.0)v(vector3(-462.21,1109.73,343.85),4.0)elseif s==12 then m[11]=nil;p(vector3(-421.4,1108.81,332.53),2.0)p(vector3(-436.92,1112.98,332.54),2.0)p(vector3(-401.12,1100.29,332.53),2.0)p(vector3(-458.45,1115.95,332.55),2.0)C(vector3(-413.05,1097.44,332.53),25.0,1000)C(vector3(-449.77,1107.41,332.53),25.0,1000)elseif s==13 then m[12]=nil;p(vector3(-413.05,1097.44,332.53),1.0)p(vector3(-449.77,1107.41,332.53),1.0)v(vector3(-431.66,1101.79,340.52),4.0)v(vector3(-401.41,1092.78,343.85),4.0)v(vector3(-439.14,1075.14,352.42),4.0)v(vector3(-462.21,1109.73,343.85),4.0)elseif s==14 then m[13]=nil;C(vector3(-401.41,1092.78,343.85),100.0,400)C(vector3(-439.14,1075.14,352.42),100.0,400)C(vector3(-462.21,1109.73,343.85),100.0,400)elseif s==15 then m[14]=nil;p(vector3(-413.05,1097.44,332.53),2.0)p(vector3(-449.77,1107.41,332.53),2.0)p(vector3(-421.4,1108.81,332.53),2.0)p(vector3(-436.92,1112.98,332.54),2.0)p(vector3(-401.12,1100.29,332.53),2.0)p(vector3(-458.45,1115.95,332.55),2.0)p(vector3(-383.67,1185.89,325.79),2.0)p(vector3(-430.62,1197.46,325.64),2.0)elseif s==16 then m[15]=nil;n=false;Citizen.Wait(5000)m=nil;o=0 end end)